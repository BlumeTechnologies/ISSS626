<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pelle Knegjes">
<meta name="dcterms.date" content="2024-09-23">

<title>Portfolio: Pelle Knegjes - Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Portfolio: Pelle Knegjes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../Master-Thesis/MasterThesis.html"> 
<span class="menu-text">Master Thesis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../ISSS626/ISSS626.html"> 
<span class="menu-text">Geospatial Analytics and Applications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../IS620/IS620.html"> 
<span class="menu-text">Digital Organization and Change Management</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/BlumeTechnologies" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/pelleknegjes" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link active" data-scroll-target="#setting-the-scene"><strong>Setting the Scene</strong></a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives"><strong>Objectives</strong></a></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><strong>The Task</strong></a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><strong>The Data</strong></a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data wrangling</a></li>
  <li><a href="#variable-selection" id="toc-variable-selection" class="nav-link" data-scroll-target="#variable-selection">variable selection</a>
  <ul class="collapse">
  <li><a href="#revenue" id="toc-revenue" class="nav-link" data-scroll-target="#revenue">Revenue</a></li>
  <li><a href="#number-of-tourists" id="toc-number-of-tourists" class="nav-link" data-scroll-target="#number-of-tourists">Number of tourists</a></li>
  <li><a href="#creating-time-periods" id="toc-creating-time-periods" class="nav-link" data-scroll-target="#creating-time-periods">Creating time periods</a></li>
  <li><a href="#global-measures-of-spatial-autocorrelation-for-tourism-numbers" id="toc-global-measures-of-spatial-autocorrelation-for-tourism-numbers" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-for-tourism-numbers"><strong>Global Measures of Spatial Autocorrelation for tourism numbers</strong></a>
  <ul class="collapse">
  <li><a href="#computing-contiguity-spatial-weights" id="toc-computing-contiguity-spatial-weights" class="nav-link" data-scroll-target="#computing-contiguity-spatial-weights"><strong>Computing Contiguity Spatial Weights</strong></a></li>
  <li><a href="#row-standardised-weights-matrix" id="toc-row-standardised-weights-matrix" class="nav-link" data-scroll-target="#row-standardised-weights-matrix"><strong>Row-standardised weights matrix</strong></a></li>
  </ul></li>
  <li><a href="#global-measures-of-spatial-autocorrelation-morans-i" id="toc-global-measures-of-spatial-autocorrelation-morans-i" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-morans-i"><strong>Global Measures of Spatial Autocorrelation: Moran’s I</strong></a>
  <ul class="collapse">
  <li><a href="#marons-i-test" id="toc-marons-i-test" class="nav-link" data-scroll-target="#marons-i-test"><strong>Maron’s I test</strong></a></li>
  <li><a href="#computing-monte-carlo-morans-i" id="toc-computing-monte-carlo-morans-i" class="nav-link" data-scroll-target="#computing-monte-carlo-morans-i"><strong>Computing Monte Carlo Moran’s I</strong></a></li>
  <li><a href="#visualising-monte-carlo-morans-i" id="toc-visualising-monte-carlo-morans-i" class="nav-link" data-scroll-target="#visualising-monte-carlo-morans-i"><strong>Visualising Monte Carlo Moran’s I</strong></a></li>
  </ul></li>
  <li><a href="#global-measures-of-spatial-autocorrelation-gearys-c" id="toc-global-measures-of-spatial-autocorrelation-gearys-c" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-gearys-c"><strong>Global Measures of Spatial Autocorrelation: Geary’s C</strong></a>
  <ul class="collapse">
  <li><a href="#gearys-c-test" id="toc-gearys-c-test" class="nav-link" data-scroll-target="#gearys-c-test"><strong>Geary’s C test</strong></a></li>
  <li><a href="#computing-monte-carlo-gearys-c" id="toc-computing-monte-carlo-gearys-c" class="nav-link" data-scroll-target="#computing-monte-carlo-gearys-c"><strong>Computing Monte Carlo Geary’s C</strong></a></li>
  <li><a href="#visualising-the-monte-carlo-gearys-c" id="toc-visualising-the-monte-carlo-gearys-c" class="nav-link" data-scroll-target="#visualising-the-monte-carlo-gearys-c"><strong>Visualising the Monte Carlo Geary’s C</strong></a></li>
  </ul></li>
  <li><a href="#spatial-correlogram" id="toc-spatial-correlogram" class="nav-link" data-scroll-target="#spatial-correlogram"><strong>Spatial Correlogram</strong></a></li>
  </ul></li>
  <li><a href="#local-measures-of-spatial-autocorrelation-for-tourism-numbers" id="toc-local-measures-of-spatial-autocorrelation-for-tourism-numbers" class="nav-link" data-scroll-target="#local-measures-of-spatial-autocorrelation-for-tourism-numbers"><strong>Local Measures of Spatial Autocorrelation for tourism numbers</strong></a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><strong>Overview</strong></a>
  <ul class="collapse">
  <li><a href="#visualising-regional-development-indicator" id="toc-visualising-regional-development-indicator" class="nav-link" data-scroll-target="#visualising-regional-development-indicator"><strong>Visualising Regional Development Indicator</strong></a></li>
  </ul></li>
  <li><a href="#local-indicators-of-spatial-associationlisa" id="toc-local-indicators-of-spatial-associationlisa" class="nav-link" data-scroll-target="#local-indicators-of-spatial-associationlisa"><strong>Local Indicators of Spatial Association(LISA)</strong></a>
  <ul class="collapse">
  <li><a href="#computing-contiguity-spatial-weights-1" id="toc-computing-contiguity-spatial-weights-1" class="nav-link" data-scroll-target="#computing-contiguity-spatial-weights-1"><strong>Computing Contiguity Spatial Weights</strong></a></li>
  <li><a href="#computing-local-morans-i" id="toc-computing-local-morans-i" class="nav-link" data-scroll-target="#computing-local-morans-i"><strong>Computing local Moran’s I</strong></a></li>
  </ul></li>
  <li><a href="#creating-a-lisa-cluster-map" id="toc-creating-a-lisa-cluster-map" class="nav-link" data-scroll-target="#creating-a-lisa-cluster-map"><strong>Creating a LISA Cluster Map</strong></a>
  <ul class="collapse">
  <li><a href="#plotting-moran-scatterplot" id="toc-plotting-moran-scatterplot" class="nav-link" data-scroll-target="#plotting-moran-scatterplot"><strong>Plotting Moran scatterplot</strong></a></li>
  <li><a href="#preparing-lisa-map-classes" id="toc-preparing-lisa-map-classes" class="nav-link" data-scroll-target="#preparing-lisa-map-classes"><strong>Preparing LISA map classes</strong></a></li>
  <li><a href="#plotting-lisa-map" id="toc-plotting-lisa-map" class="nav-link" data-scroll-target="#plotting-lisa-map"><strong>Plotting LISA map</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hot-spot-and-cold-spot-area-analysis" id="toc-hot-spot-and-cold-spot-area-analysis" class="nav-link" data-scroll-target="#hot-spot-and-cold-spot-area-analysis"><strong>Hot Spot and Cold Spot Area Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#getis-and-ords-g-statistics" id="toc-getis-and-ords-g-statistics" class="nav-link" data-scroll-target="#getis-and-ords-g-statistics"><strong>Getis and Ord’s G-Statistics</strong></a></li>
  <li><a href="#deriving-distance-based-weight-matrix" id="toc-deriving-distance-based-weight-matrix" class="nav-link" data-scroll-target="#deriving-distance-based-weight-matrix"><strong>Deriving distance-based weight matrix</strong></a></li>
  <li><a href="#computing-adaptive-distance-weight-matrix" id="toc-computing-adaptive-distance-weight-matrix" class="nav-link" data-scroll-target="#computing-adaptive-distance-weight-matrix"><strong>Computing adaptive distance weight matrix</strong></a></li>
  <li><a href="#computing-gi-statistics" id="toc-computing-gi-statistics" class="nav-link" data-scroll-target="#computing-gi-statistics"><strong>Computing Gi statistics</strong></a>
  <ul class="collapse">
  <li><a href="#gi-statistics-using-fixed-distance" id="toc-gi-statistics-using-fixed-distance" class="nav-link" data-scroll-target="#gi-statistics-using-fixed-distance"><strong>Gi statistics using fixed distance</strong></a></li>
  <li><a href="#mapping-gi-values-with-fixed-distance-weights" id="toc-mapping-gi-values-with-fixed-distance-weights" class="nav-link" data-scroll-target="#mapping-gi-values-with-fixed-distance-weights"><strong>Mapping Gi values with fixed distance weights</strong></a></li>
  <li><a href="#gi-statistics-using-adaptive-distance" id="toc-gi-statistics-using-adaptive-distance" class="nav-link" data-scroll-target="#gi-statistics-using-adaptive-distance"><strong>Gi statistics using adaptive distance</strong></a></li>
  <li><a href="#mapping-gi-values-with-adaptive-distance-weights" id="toc-mapping-gi-values-with-adaptive-distance-weights" class="nav-link" data-scroll-target="#mapping-gi-values-with-adaptive-distance-weights"><strong>Mapping Gi values with adaptive distance weights</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cold-hot-map-tourism" id="toc-cold-hot-map-tourism" class="nav-link" data-scroll-target="#cold-hot-map-tourism">Cold hot map tourism</a></li>
  <li><a href="#revenue-analysis" id="toc-revenue-analysis" class="nav-link" data-scroll-target="#revenue-analysis">Revenue analysis</a>
  <ul class="collapse">
  <li><a href="#creating-time-periods-1" id="toc-creating-time-periods-1" class="nav-link" data-scroll-target="#creating-time-periods-1">Creating time periods</a></li>
  <li><a href="#global-measures-of-spatial-autocorrelation-for-tourism-numbers-1" id="toc-global-measures-of-spatial-autocorrelation-for-tourism-numbers-1" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-for-tourism-numbers-1"><strong>Global Measures of Spatial Autocorrelation for tourism numbers</strong></a>
  <ul class="collapse">
  <li><a href="#computing-contiguity-spatial-weights-2" id="toc-computing-contiguity-spatial-weights-2" class="nav-link" data-scroll-target="#computing-contiguity-spatial-weights-2"><strong>Computing Contiguity Spatial Weights</strong></a></li>
  <li><a href="#row-standardised-weights-matrix-1" id="toc-row-standardised-weights-matrix-1" class="nav-link" data-scroll-target="#row-standardised-weights-matrix-1"><strong>Row-standardised weights matrix</strong></a></li>
  </ul></li>
  <li><a href="#global-measures-of-spatial-autocorrelation-morans-i-1" id="toc-global-measures-of-spatial-autocorrelation-morans-i-1" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-morans-i-1"><strong>Global Measures of Spatial Autocorrelation: Moran’s I</strong></a>
  <ul class="collapse">
  <li><a href="#marons-i-test-1" id="toc-marons-i-test-1" class="nav-link" data-scroll-target="#marons-i-test-1"><strong>Maron’s I test</strong></a></li>
  <li><a href="#computing-monte-carlo-morans-i-1" id="toc-computing-monte-carlo-morans-i-1" class="nav-link" data-scroll-target="#computing-monte-carlo-morans-i-1"><strong>Computing Monte Carlo Moran’s I</strong></a></li>
  <li><a href="#visualising-monte-carlo-morans-i-1" id="toc-visualising-monte-carlo-morans-i-1" class="nav-link" data-scroll-target="#visualising-monte-carlo-morans-i-1"><strong>Visualising Monte Carlo Moran’s I</strong></a></li>
  </ul></li>
  <li><a href="#global-measures-of-spatial-autocorrelation-gearys-c-1" id="toc-global-measures-of-spatial-autocorrelation-gearys-c-1" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-gearys-c-1"><strong>Global Measures of Spatial Autocorrelation: Geary’s C</strong></a>
  <ul class="collapse">
  <li><a href="#gearys-c-test-1" id="toc-gearys-c-test-1" class="nav-link" data-scroll-target="#gearys-c-test-1"><strong>Geary’s C test</strong></a></li>
  <li><a href="#computing-monte-carlo-gearys-c-1" id="toc-computing-monte-carlo-gearys-c-1" class="nav-link" data-scroll-target="#computing-monte-carlo-gearys-c-1"><strong>Computing Monte Carlo Geary’s C</strong></a></li>
  <li><a href="#visualising-the-monte-carlo-gearys-c-1" id="toc-visualising-the-monte-carlo-gearys-c-1" class="nav-link" data-scroll-target="#visualising-the-monte-carlo-gearys-c-1"><strong>Visualising the Monte Carlo Geary’s C</strong></a></li>
  </ul></li>
  <li><a href="#spatial-correlogram-1" id="toc-spatial-correlogram-1" class="nav-link" data-scroll-target="#spatial-correlogram-1"><strong>Spatial Correlogram</strong></a></li>
  </ul></li>
  <li><a href="#local-measures-of-spatial-autocorrelation-for-total-revenue" id="toc-local-measures-of-spatial-autocorrelation-for-total-revenue" class="nav-link" data-scroll-target="#local-measures-of-spatial-autocorrelation-for-total-revenue"><strong>Local Measures of Spatial Autocorrelation for total Revenue</strong></a>
  <ul class="collapse">
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1"><strong>Overview</strong></a>
  <ul class="collapse">
  <li><a href="#visualising-regional-development-indicator-1" id="toc-visualising-regional-development-indicator-1" class="nav-link" data-scroll-target="#visualising-regional-development-indicator-1"><strong>Visualising Regional Development Indicator</strong></a></li>
  </ul></li>
  <li><a href="#local-indicators-of-spatial-associationlisa-1" id="toc-local-indicators-of-spatial-associationlisa-1" class="nav-link" data-scroll-target="#local-indicators-of-spatial-associationlisa-1"><strong>Local Indicators of Spatial Association(LISA)</strong></a>
  <ul class="collapse">
  <li><a href="#computing-contiguity-spatial-weights-3" id="toc-computing-contiguity-spatial-weights-3" class="nav-link" data-scroll-target="#computing-contiguity-spatial-weights-3"><strong>Computing Contiguity Spatial Weights</strong></a></li>
  <li><a href="#row-standardised-weights-matrix-2" id="toc-row-standardised-weights-matrix-2" class="nav-link" data-scroll-target="#row-standardised-weights-matrix-2"><strong>Row-standardised weights matrix</strong></a></li>
  <li><a href="#computing-local-morans-i-1" id="toc-computing-local-morans-i-1" class="nav-link" data-scroll-target="#computing-local-morans-i-1"><strong>Computing local Moran’s I</strong></a></li>
  </ul></li>
  <li><a href="#creating-a-lisa-cluster-map-1" id="toc-creating-a-lisa-cluster-map-1" class="nav-link" data-scroll-target="#creating-a-lisa-cluster-map-1"><strong>Creating a LISA Cluster Map</strong></a>
  <ul class="collapse">
  <li><a href="#plotting-moran-scatterplot-1" id="toc-plotting-moran-scatterplot-1" class="nav-link" data-scroll-target="#plotting-moran-scatterplot-1"><strong>Plotting Moran scatterplot</strong></a></li>
  <li><a href="#preparing-lisa-map-classes-1" id="toc-preparing-lisa-map-classes-1" class="nav-link" data-scroll-target="#preparing-lisa-map-classes-1"><strong>Preparing LISA map classes</strong></a></li>
  <li><a href="#plotting-lisa-map-1" id="toc-plotting-lisa-map-1" class="nav-link" data-scroll-target="#plotting-lisa-map-1"><strong>Plotting LISA map</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hot-spot-and-cold-spot-area-analysis-1" id="toc-hot-spot-and-cold-spot-area-analysis-1" class="nav-link" data-scroll-target="#hot-spot-and-cold-spot-area-analysis-1"><strong>Hot Spot and Cold Spot Area Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#getis-and-ords-g-statistics-1" id="toc-getis-and-ords-g-statistics-1" class="nav-link" data-scroll-target="#getis-and-ords-g-statistics-1"><strong>Getis and Ord’s G-Statistics</strong></a></li>
  <li><a href="#deriving-distance-based-weight-matrix-1" id="toc-deriving-distance-based-weight-matrix-1" class="nav-link" data-scroll-target="#deriving-distance-based-weight-matrix-1"><strong>Deriving distance-based weight matrix</strong></a></li>
  <li><a href="#computing-adaptive-distance-weight-matrix-1" id="toc-computing-adaptive-distance-weight-matrix-1" class="nav-link" data-scroll-target="#computing-adaptive-distance-weight-matrix-1"><strong>Computing adaptive distance weight matrix</strong></a></li>
  <li><a href="#computing-gi-statistics-1" id="toc-computing-gi-statistics-1" class="nav-link" data-scroll-target="#computing-gi-statistics-1"><strong>Computing Gi statistics</strong></a>
  <ul class="collapse">
  <li><a href="#gi-statistics-using-fixed-distance-1" id="toc-gi-statistics-using-fixed-distance-1" class="nav-link" data-scroll-target="#gi-statistics-using-fixed-distance-1"><strong>Gi statistics using fixed distance</strong></a></li>
  <li><a href="#mapping-gi-values-with-fixed-distance-weights-1" id="toc-mapping-gi-values-with-fixed-distance-weights-1" class="nav-link" data-scroll-target="#mapping-gi-values-with-fixed-distance-weights-1"><strong>Mapping Gi values with fixed distance weights</strong></a></li>
  <li><a href="#gi-statistics-using-adaptive-distance-1" id="toc-gi-statistics-using-adaptive-distance-1" class="nav-link" data-scroll-target="#gi-statistics-using-adaptive-distance-1"><strong>Gi statistics using adaptive distance</strong></a></li>
  <li><a href="#mapping-gi-values-with-adaptive-distance-weights-1" id="toc-mapping-gi-values-with-adaptive-distance-weights-1" class="nav-link" data-scroll-target="#mapping-gi-values-with-adaptive-distance-weights-1"><strong>Mapping Gi values with adaptive distance weights</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cold-hot-map-revenue" id="toc-cold-hot-map-revenue" class="nav-link" data-scroll-target="#cold-hot-map-revenue">Cold hot map Revenue</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pelle Knegjes </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 13, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="setting-the-scene" class="level2">
<h2 class="anchored" data-anchor-id="setting-the-scene"><strong>Setting the Scene</strong></h2>
<p>Tourism is one of Thailand’s largest industries, accounting for some 20% of the gross domestic product (GDP). In 2019, Thailand earned 90 billion US$ from domestic and international tourism, but the COVID-19 pandemic caused revenues to crash to 24 billion US$ in 2020.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives"><strong>Objectives</strong></h2>
<p>As a curious geospatial analytics green horn, we are interested to discover:</p>
<ul>
<li><p>if the key indicators of tourism economy of Thailand are independent from space and space and time.</p></li>
<li><p>If the tourism economy is indeed spatial and spatio-temporal dependent, then, we would like to detect where are the clusters and outliers, and the emerging hot spot/cold spot areas.</p></li>
</ul>
</section>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task"><strong>The Task</strong></h2>
<p>The specific tasks of this take-home exercise are as follows:</p>
<ul>
<li><p>Using appropriate function of <strong>sf</strong> and <strong>tidyverse</strong>, preparing the following geospatial data layer:</p>
<ul>
<li><p>a study area layer in sf polygon features. It must be at <a href="https://en.wikipedia.org/wiki/Provinces_of_Thailand">province level</a> (including Bangkok) of Thailand.</p></li>
<li><p>a tourism economy indicators layer within the study area in sf polygon features.</p></li>
<li><p>a derived tourism economy indicator layer in <a href="https://sfdep.josiahparry.com/articles/spacetime-s3"><strong>spacetime s3 class of sfdep</strong></a>. Keep the time series at <strong>month and year levels</strong>.</p></li>
</ul></li>
<li><p>Using the extracted data, perform global spatial autocorrelation analysis by using <a href="https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex05/in-class_ex05-glsa">sfdep methods</a>.</p></li>
<li><p>Using the extracted data, perform local spatial autocorrelation analysis by using <a href="https://r4gdsa.netlify.app/chap10.html">sfdep methods</a>.</p></li>
<li><p>Using the extracted data, perform emerging hotspot analysis by using <a href="https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex05/in-class_ex05-ehsa">sfdep methods</a>.</p></li>
<li><p>Describe the spatial patterns revealed by the analysis above.</p></li>
</ul>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data"><strong>The Data</strong></h2>
<p>For the purpose of this take-home exercise, two data sets shall be used, they are:</p>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Thailand Domestic Tourism Statistics</a> at Kaggle. You are required to use <strong>version 2</strong> of the data set.</p></li>
<li><p><a href="https://data.humdata.org/dataset/cod-ab-tha?">Thailand - Subnational Administrative Boundaries</a> at HDX. You are required to use the province boundary data set.</p></li>
</ul>
<p>need to combine small islands to make sure the centroid is not in the ocean</p>
<p>look at multiple key indicators of trousism</p>
<p>space time cross sectional before covid, during covid, after covid</p>
<p>keep time series at month year level</p>
<p>How to interpet:</p>
<p>Look at articles</p>
<p>spacetimebox needs to be interger for months</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(spdep, tmap, sf, ClustGeo, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, cluster, factoextra, NbClust,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               heatmaply, corrplot, psych, tidyverse, GGally,sf, spdep, tmap, tidyverse, sfdep, plotly, Kendall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-wrangling" class="level1">
<h1>Data wrangling</h1>
<p>first we load the geo data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>admRAW <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">layer =</span> <span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `C:\BlumeTechnologies\ISSS626\ISSS626\Take-Home_Exercises\Take-Home_Exercise02\data\rawdata' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(admRAW)[<span class="fu">names</span>(admRAW) <span class="sc">==</span> <span class="st">'ADM1_EN'</span>] <span class="ot">&lt;-</span> <span class="st">"province_eng"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we load the tourism data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>TourismRAW <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/thailand_domestic_tourism_2019_2023_ver2.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(date))<span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 30800 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (5): province_thai, province_eng, region_thai, region_eng, variable
dbl  (1): value
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="variable-selection" class="level1">
<h1>variable selection</h1>
<p>now we pick two variables to further look at</p>
<section id="revenue" class="level2">
<h2 class="anchored" data-anchor-id="revenue">Revenue</h2>
<p>This variable shows all revenue from tourism</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset for a specific variable</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>revallRAW <span class="ot">&lt;-</span> TourismRAW <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"revenue_all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="number-of-tourists" class="level2">
<h2 class="anchored" data-anchor-id="number-of-tourists">Number of tourists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset for a specific variable</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>touristRAW <span class="ot">&lt;-</span> TourismRAW <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"no_tourist_all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-time-periods" class="level2">
<h2 class="anchored" data-anchor-id="creating-time-periods">Creating time periods</h2>
<p>we create pre covid(Pre), during covid(Cov) and post covid(Post) time periods to see the difference between them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>precovnum <span class="ot">&lt;-</span> touristRAW <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>covnum <span class="ot">&lt;-</span> touristRAW <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2021</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>postcovnum <span class="ot">&lt;-</span> touristRAW <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2022</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2023</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate values for each period per province</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>precovnum <span class="ot">&lt;-</span> precovnum <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>covnum <span class="ot">&lt;-</span> covnum <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>postcovnum <span class="ot">&lt;-</span> postcovnum <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Pre <span class="ot">&lt;-</span> <span class="fu">left_join</span>(admRAW,precovnum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_eng)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Pre <span class="ot">&lt;-</span> Pre[<span class="sc">!</span><span class="fu">is.na</span>(Pre<span class="sc">$</span>value), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.61, 0.54, 0.54, 0.54, 0.54. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.65, 0.59, 0.59, 0.56. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Cov <span class="ot">&lt;-</span> <span class="fu">left_join</span>(admRAW,covnum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_eng)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Cov <span class="ot">&lt;-</span> Cov[<span class="sc">!</span><span class="fu">is.na</span>(Cov<span class="sc">$</span>value), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.65, 0.56, 0.54, 0.54, 0.54. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.65, 0.59, 0.59, 0.56. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Post <span class="ot">&lt;-</span> <span class="fu">left_join</span>(admRAW,postcovnum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_eng)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Post <span class="ot">&lt;-</span> Post[<span class="sc">!</span><span class="fu">is.na</span>(Post<span class="sc">$</span>value), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.65, 0.56, 0.54, 0.54, 0.54. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.65, 0.59, 0.59, 0.56. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="global-measures-of-spatial-autocorrelation-for-tourism-numbers" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-for-tourism-numbers"><strong>Global Measures of Spatial Autocorrelation for tourism numbers</strong></h2>
<section id="computing-contiguity-spatial-weights" class="level3">
<h3 class="anchored" data-anchor-id="computing-contiguity-spatial-weights"><strong>Computing Contiguity Spatial Weights</strong></h3>
<p>Before we can compute the global spatial autocorrelation statistics, we need to construct a spatial weights of the study area. The spatial weights is used to define the neighbourhood relationships between the geographical units (i.e.&nbsp;county) in the study area.</p>
<p>In the code chunk below, <a href="https://r-spatial.github.io/spdep/reference/poly2nb.html"><code>poly2nb()</code></a> of <strong>spdep</strong> package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries. If you look at the documentation you will see that you can pass a “queen” argument that takes TRUE or FALSE as options. If you do not specify this argument the default is set to TRUE, that is, if you don’t specify queen = FALSE this function will return a list of first order neighbours using the Queen criteria.</p>
<p>More specifically, the code chunk below is used to compute Queen contiguity weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>wm_q1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Pre, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>wm_q2 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Cov, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>wm_q3 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Post, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</section>
<section id="row-standardised-weights-matrix" class="level3">
<h3 class="anchored" data-anchor-id="row-standardised-weights-matrix"><strong>Row-standardised weights matrix</strong></h3>
<p>Next, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values. While this is the most intuitive way to summaries the neighbors’ values it has one drawback in that polygons along the edges of the study area will base their lagged values on fewer polygons thus potentially over- or under-estimating the true nature of the spatial autocorrelation in the data. For this example, we’ll stick with the style=“W” option for simplicity’s sake but note that other more robust options are available, notably style=“B”.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rswm_q1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q1, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>rswm_q1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rswm_q2 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q2, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>rswm_q2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>rswm_q3 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q3, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>rswm_q3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="global-measures-of-spatial-autocorrelation-morans-i" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-morans-i"><strong>Global Measures of Spatial Autocorrelation: Moran’s I</strong></h2>
<section id="marons-i-test" class="level3">
<h3 class="anchored" data-anchor-id="marons-i-test"><strong>Maron’s I test</strong></h3>
<p>The code chunk below performs Moran’s I statistical testing using <a href="https://r-spatial.github.io/spdep/reference/moran.test.html"><code>moran.test()</code></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">COV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Pre<span class="sc">$</span>value, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q1, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Pre$value  
weights: rswm_q1  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = 0.059901, p-value = 0.4761
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.012400306      -0.014925373       0.001776985 </code></pre>
</div>
</div>
<p>Question: What statistical conclusion can you draw from the output above?</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Cov<span class="sc">$</span>value, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q2, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Cov$value  
weights: rswm_q2  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = -0.17578, p-value = 0.5698
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.024599591      -0.014925373       0.003028912 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Post<span class="sc">$</span>value, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q3, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Post$value  
weights: rswm_q3  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = 0.5019, p-value = 0.3079
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.012495405      -0.014925373       0.002984828 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-monte-carlo-morans-i" class="level3">
<h3 class="anchored" data-anchor-id="computing-monte-carlo-morans-i"><strong>Computing Monte Carlo Moran’s I</strong></h3>
<p>The code chunk below performs permutation test for Moran’s I statistic by using <a href="https://r-spatial.github.io/spdep/reference/moran.mc.html"><code>moran.mc()</code></a> of <strong>spdep</strong>. A total of 1000 simulation will be performed.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>bperm1<span class="ot">=</span> <span class="fu">moran.mc</span>(Pre<span class="sc">$</span>value, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q1, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>bperm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Pre$value 
weights: rswm_q1  
number of simulations + 1: 1000 

statistic = -0.0124, observed rank = 593, p-value = 0.407
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>bperm2<span class="ot">=</span> <span class="fu">moran.mc</span>(Cov<span class="sc">$</span>value, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q2, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>bperm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Cov$value 
weights: rswm_q2  
number of simulations + 1: 1000 

statistic = -0.0246, observed rank = 468, p-value = 0.532
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>bperm3<span class="ot">=</span> <span class="fu">moran.mc</span>(Post<span class="sc">$</span>value, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q3, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>bperm3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Post$value 
weights: rswm_q3  
number of simulations + 1: 1000 

statistic = 0.012495, observed rank = 732, p-value = 0.268
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualising-monte-carlo-morans-i" class="level3">
<h3 class="anchored" data-anchor-id="visualising-monte-carlo-morans-i"><strong>Visualising Monte Carlo Moran’s I</strong></h3>
<p>It is always a good practice for us the examine the simulated Moran’s I test statistics in greater detail. This can be achieved by plotting the distribution of the statistical values as a histogram by using the code chunk below.</p>
<p>In the code chunk below <a href="https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/hist"><code>hist()</code></a> and <a href="https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/abline"><code>abline()</code></a> of R Graphics are used.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">COV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm1<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01448913</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm1<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001841251</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm1<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.126342 -0.044262 -0.021250 -0.014489  0.008892  0.185379 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm1<span class="sc">$</span>res, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm2<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01374542</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm2<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002689352</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm2<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.14235 -0.05268 -0.02155 -0.01375  0.01483  0.23047 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm2<span class="sc">$</span>res, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm3<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01460814</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm3<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003158902</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm3<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.14036 -0.05476 -0.02422 -0.01461  0.01721  0.26101 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm3<span class="sc">$</span>res, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="global-measures-of-spatial-autocorrelation-gearys-c" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-gearys-c"><strong>Global Measures of Spatial Autocorrelation: Geary’s C</strong></h2>
<section id="gearys-c-test" class="level3">
<h3 class="anchored" data-anchor-id="gearys-c-test"><strong>Geary’s C test</strong></h3>
<p>The code chunk below performs Geary’s C test for spatial autocorrelation by using <a href="https://r-spatial.github.io/spdep/reference/geary.test.html"><code>geary.test()</code></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Pre<span class="sc">$</span>value, <span class="at">listw=</span>rswm_q1, <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Pre$value 
weights: rswm_q1  
n reduced by no-neighbour observations 

Geary C statistic standard deviate = -0.94014, p-value = 0.8264
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       1.17516453        1.00000000        0.03471391 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Cov<span class="sc">$</span>value, <span class="at">listw=</span>rswm_q2, <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Cov$value 
weights: rswm_q2  
n reduced by no-neighbour observations 

Geary C statistic standard deviate = -1.1058, p-value = 0.8656
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       1.18764283        1.00000000        0.02879367 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Post<span class="sc">$</span>value, <span class="at">listw=</span>rswm_q3, <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Post$value 
weights: rswm_q3  
n reduced by no-neighbour observations 

Geary C statistic standard deviate = -0.84132, p-value = 0.7999
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       1.14327764        1.00000000        0.02900214 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-monte-carlo-gearys-c" class="level3">
<h3 class="anchored" data-anchor-id="computing-monte-carlo-gearys-c"><strong>Computing Monte Carlo Geary’s C</strong></h3>
<p>The code chunk below performs permutation test for Geary’s C statistic by using <a href="https://r-spatial.github.io/spdep/reference/geary.mc.html"><code>geary.mc()</code></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>bperm11<span class="ot">=</span><span class="fu">geary.mc</span>(Pre<span class="sc">$</span>value, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>rswm_q1, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action=</span>na.omit)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>bperm11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Pre$value 
weights: rswm_q1  
number of simulations + 1: 1000 

statistic = 1.1752, observed rank = 826, p-value = 0.826
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>bperm22<span class="ot">=</span><span class="fu">geary.mc</span>(Cov<span class="sc">$</span>value, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>rswm_q2, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action=</span>na.omit)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>bperm22</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Cov$value 
weights: rswm_q2  
number of simulations + 1: 1000 

statistic = 1.1876, observed rank = 879, p-value = 0.879
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>bperm33<span class="ot">=</span><span class="fu">geary.mc</span>(Post<span class="sc">$</span>value, </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>rswm_q3, </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action=</span>na.omit)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>bperm33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Post$value 
weights: rswm_q3  
number of simulations + 1: 1000 

statistic = 1.1433, observed rank = 804, p-value = 0.804
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualising-the-monte-carlo-gearys-c" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-monte-carlo-gearys-c"><strong>Visualising the Monte Carlo Geary’s C</strong></h3>
<p>Next, we will plot a histogram to reveal the distribution of the simulated values by using the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm11<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9815672</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm11<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04837946</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm11<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.09313 0.85944 0.97396 0.98157 1.12800 1.73436 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm11<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm22<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9834957</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm22<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03898419</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm22<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1764  0.8734  0.9779  0.9835  1.1095  1.6578 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm22<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm33<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.983886</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm33<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03950756</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm33<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1851  0.8752  0.9738  0.9839  1.1113  1.6770 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm33<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="spatial-correlogram" class="level2">
<h2 class="anchored" data-anchor-id="spatial-correlogram"><strong>Spatial Correlogram</strong></h2>
<p>Spatial correlograms are great to examine patterns of spatial autocorrelation in your data or model residuals. They show how correlated are pairs of spatial observations when you increase the distance (lag) between them - they are plots of some index of autocorrelation (Moran’s I or Geary’s c) against distance.Although correlograms are not as fundamental as variograms (a keystone concept of geostatistics), they are very useful as an exploratory and descriptive tool. For this purpose they actually provide richer information than variograms.</p>
</section>
</section>
<section id="local-measures-of-spatial-autocorrelation-for-tourism-numbers" class="level1">
<h1><strong>Local Measures of Spatial Autocorrelation for tourism numbers</strong></h1>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview"><strong>Overview</strong></h2>
<p>Local Measures of Spatial Autocorrelation (LMSA) focus on the relationships between each observation and its surroundings, rather than providing a single summary of these relationships across the map. In this sense, they are not summary statistics but scores that allow us to learn more about the spatial structure in our data. The general intuition behind the metrics however is similar to that of global ones. Some of them are even mathematically connected, where the global version can be decomposed into a collection of local ones. One such example are Local Indicators of Spatial Association (LISA). Beside LISA, Getis-Ord’s Gi-statistics will be introduce as an alternative LMSA statistics that present complementary information or allow us to obtain similar insights for geographically referenced data.</p>
<section id="visualising-regional-development-indicator" class="level3">
<h3 class="anchored" data-anchor-id="visualising-regional-development-indicator"><strong>Visualising Regional Development Indicator</strong></h3>
<p>Now, we are going to prepare a basemap and a choropleth map showing the distribution of Tourism by using <em>qtm()</em> of <strong>tmap</strong> package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.61, 0.54, 0.54, 0.54, 0.54. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.65, 0.59, 0.59, 0.56. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.65, 0.56, 0.54, 0.54, 0.54. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.65, 0.59, 0.59, 0.56. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.65, 0.56, 0.54, 0.54, 0.54. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.65, 0.59, 0.59, 0.56. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="local-indicators-of-spatial-associationlisa" class="level2">
<h2 class="anchored" data-anchor-id="local-indicators-of-spatial-associationlisa"><strong>Local Indicators of Spatial Association(LISA)</strong></h2>
<p>Local Indicators of Spatial Association or LISA are statistics that evaluate the existence of clusters and/or outliers in the spatial arrangement of a given variable.</p>
<section id="computing-contiguity-spatial-weights-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-contiguity-spatial-weights-1"><strong>Computing Contiguity Spatial Weights</strong></h3>
<p>Before we can compute the local spatial autocorrelation statistics, we need to construct a spatial weights of the study area. The spatial weights is used to define the neighbourhood relationships between the geographical units (i.e.&nbsp;county) in the study area.</p>
<p>In the code chunk below, <a href="https://r-spatial.github.io/spdep/reference/poly2nb.html"><code>poly2nb()</code></a> of <strong>spdep</strong> package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries. If you look at the documentation you will see that you can pass a “queen” argument that takes TRUE or FALSE as options. If you do not specify this argument the default is set to TRUE, that is, if you don’t specify queen = FALSE this function will return a list of first order neighbours using the Queen criteria.</p>
<p>More specifically, the code chunk below is used to compute Queen contiguity weight matrix.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>localwm_q1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Pre, </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localwm_q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>localwm_q2 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Cov, </span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localwm_q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>localwm_q3 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Post, </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localwm_q3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The summary report above shows that there are 69 area units in thailand. The most connected area unit has 9 neighbours. ### <strong>Row-standardised weights matrix</strong></p>
<p>Next, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values. While this is the most intuitive way to summaries the neighbors’ values it has one drawback in that polygons along the edges of the study area will base their lagged values on fewer polygons thus potentially over- or under-estimating the true nature of the spatial autocorrelation in the data. For this example, we’ll stick with the style=“W” option for simplicity’s sake but note that other more robust options are available, notably style=“B”.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rswm_qlocal1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(localwm_q1, </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>rswm_qlocal1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>rswm_qlocal2 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(localwm_q2, </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>rswm_qlocal2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>rswm_qlocal3 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(localwm_q3, </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>rswm_qlocal3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-local-morans-i" class="level3">
<h3 class="anchored" data-anchor-id="computing-local-morans-i"><strong>Computing local Moran’s I</strong></h3>
<p>To compute local Moran’s I, the <a href="https://r-spatial.github.io/spdep/reference/localmoran.html"><em>localmoran()</em></a> function of <strong>spdep</strong> will be used. It computes <em>Ii</em> values, given a set of <em>zi</em> values and a listw object providing neighbour weighting information for the polygon associated with the zi values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>fips1 <span class="ot">&lt;-</span> <span class="fu">order</span>(Pre<span class="sc">$</span>value)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>localMI1 <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Pre<span class="sc">$</span>value, rswm_qlocal1)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Ii          E.Ii      Var.Ii         Z.Ii Pr(z != E(Ii))
1 -0.962678084 -8.721961e-01 1.186241060 -0.083076005   9.337911e-01
2 -0.223820407 -5.047251e-05 0.001715225 -5.403076685   6.550744e-08
3 -0.283318794 -2.922175e-04 0.004813639 -4.079345204   4.516273e-05
4 -0.298101852 -7.399141e-04 0.007868185 -3.352340263   8.013147e-04
5 -0.065859788 -4.124509e-03 0.043711133 -0.295282278   7.677783e-01
6 -0.004149839 -2.154500e-03 0.047970715 -0.009110214   9.927312e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>fips2 <span class="ot">&lt;-</span> <span class="fu">order</span>(Cov<span class="sc">$</span>value)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>localMI2 <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Cov<span class="sc">$</span>value, rswm_qlocal2)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii          E.Ii      Var.Ii       Z.Ii Pr(z != E(Ii))
1 -1.35527205 -0.7724074607 1.870764881 -0.4261457   6.700017e-01
2 -0.82957575 -0.0007499084 0.025466582 -5.1937130   2.061408e-07
3 -0.33037150 -0.0004480210 0.007379009 -3.8407338   1.226671e-04
4 -0.42654266 -0.0015760652 0.016745722 -3.2839978   1.023457e-03
5 -0.10232253 -0.0067901706 0.071768922 -0.3566008   7.213907e-01
6 -0.03975591 -0.0031298405 0.069618906 -0.1388119   8.895988e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>fips3 <span class="ot">&lt;-</span> <span class="fu">order</span>(Post<span class="sc">$</span>value)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>localMI3 <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Post<span class="sc">$</span>value, rswm_qlocal3)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii          E.Ii      Var.Ii        Z.Ii Pr(z != E(Ii))
1 -0.71729377 -7.762773e-01 1.848169007  0.04338702   9.653930e-01
2 -0.39591276 -1.603260e-04 0.005447816 -5.36182196   8.238672e-08
3 -0.14677611 -7.954655e-05 0.001310633 -4.05209309   5.076146e-05
4 -0.36584764 -1.001833e-03 0.010650616 -3.53526517   4.073661e-04
5 -0.06354218 -1.441570e-02 0.151197357 -0.12634078   8.994622e-01
6 -0.10909582 -2.881476e-03 0.064110345 -0.41948759   6.748598e-01</code></pre>
</div>
</div>
<p><em>localmoran()</em> function returns a matrix of values whose columns are:</p>
<ul>
<li><p>Ii: the local Moran’s I statistics</p></li>
<li><p>E.Ii: the expectation of local moran statistic under the randomisation hypothesis</p></li>
<li><p>Var.Ii: the variance of local moran statistic under the randomisation hypothesis</p></li>
<li><p>Z.Ii:the standard deviate of local moran statistic</p></li>
<li><p>Pr(): the p-value of local moran statistic</p></li>
</ul>
<p>The code chunk below list the content of the local Moran matrix derived by using <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/printCoefmat"><em>printCoefmat()</em></a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  localMI1[fips1,], </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Pre<span class="sc">$</span>value[fips1]),</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..
282059    5.4637e-02 -2.9721e-03  6.6121e-02  2.2404e-01         0.8227
306727    1.0778e-01 -2.9324e-03  6.5239e-02  4.3346e-01         0.6647
577495    9.8377e-02 -2.5138e-03  5.5951e-02  4.2653e-01         0.6697
606194    1.0965e-01 -2.4713e-03  5.5008e-02  4.7805e-01         0.6326
621877    1.1569e-01 -2.4483e-03  4.0243e-02  5.8890e-01         0.5559
657377    1.1015e-01 -2.3965e-03  3.9394e-02  5.6703e-01         0.5707
689938    5.5220e-02 -2.3495e-03  5.2301e-02  2.5173e-01         0.8012
703810    1.6901e-01 -2.3296e-03  7.8986e-02  6.0964e-01         0.5421
747775    8.5746e-02 -2.2671e-03  3.7272e-02  4.5589e-01         0.6485
768297    7.1504e-02 -2.2382e-03  2.3765e-02  4.7835e-01         0.6324
772404   -1.4819e-02 -2.2325e-03  3.6703e-02 -6.5697e-02         0.9476
782901    9.3719e-02 -2.2178e-03  2.8714e-02  5.6615e-01         0.5713
828556   -4.1498e-03 -2.1545e-03  4.7971e-02 -9.1102e-03         0.9927
865646    1.3168e-01 -2.1038e-03  2.7241e-02  8.1054e-01         0.4176
889499    8.4457e-02 -2.0715e-03  3.4062e-02  4.6884e-01         0.6392
920622    1.2828e-01 -2.0297e-03  2.6284e-02  8.0380e-01         0.4215
953895    1.3882e-01 -1.9855e-03  4.4215e-02  6.6965e-01         0.5031
1003731   1.1144e-02 -1.9202e-03  6.5133e-02  5.1191e-02         0.9592
1084036   9.8534e-02 -1.8173e-03  2.9890e-02  5.8044e-01         0.5616
1094469  -1.1775e-01 -1.8041e-03  6.1203e-02 -4.6869e-01         0.6393
1152319   1.0882e-01 -1.7320e-03  3.8581e-02  5.6285e-01         0.5735
1205342  -3.9828e-02 -1.6672e-03  3.7140e-02 -1.9801e-01         0.8430
1362257   3.5153e-02 -1.4827e-03  1.3287e-02  3.1783e-01         0.7506
1374982   7.9234e-02 -1.4682e-03  1.5601e-02  6.4611e-01         0.5182
1420755   1.1859e-01 -1.4167e-03  4.8078e-02  5.4729e-01         0.5842
1501482   8.6097e-02 -1.3280e-03  1.4114e-02  7.3589e-01         0.4618
1514747  -2.7813e-02 -1.3137e-03  2.9275e-02 -1.5488e-01         0.8769
1515458  -5.4565e-01 -1.3130e-03  2.1606e-02 -3.7032e+00         0.0002
1556230   1.4210e-02 -1.2695e-03  2.8292e-02  9.2027e-02         0.9267
1563563   1.8705e-02 -1.2618e-03  2.0765e-02  1.3856e-01         0.8898
1626132   1.2280e-02 -1.1968e-03  1.9696e-02  9.6026e-02         0.9235
1804320  -6.4555e-02 -1.0210e-03  2.2759e-02 -4.2114e-01         0.6737
1935609   8.1015e-02 -9.0044e-04  9.5736e-03  8.3720e-01         0.4025
2074134  -8.6841e-03 -7.8143e-04  1.7423e-02 -5.9871e-02         0.9523
2116182   8.5468e-02 -7.4697e-04  7.9432e-03  9.6736e-01         0.3334
2124911  -2.9810e-01 -7.3991e-04  7.8682e-03 -3.3523e+00         0.0008
2224944  -3.4300e-02 -6.6145e-04  1.4749e-02 -2.7698e-01         0.7818
2255255   1.7552e-02 -6.3854e-04  4.3082e-03  2.7713e-01         0.7817
2257616   8.3994e-03 -6.3677e-04  8.2576e-03  9.9439e-02         0.9208
2278251   3.7075e-02 -6.2143e-04  4.2852e-02  1.8210e-01         0.8555
2330827  -3.2107e-02 -5.8318e-04  7.5630e-03 -3.6249e-01         0.7170
2411076   3.0636e-02 -5.2715e-04  5.6068e-03  4.1618e-01         0.6773
2484480  -3.9153e-05 -4.7837e-04  7.8786e-03  4.9483e-03         0.9961
2787870   3.3193e-02 -3.0188e-04  4.9727e-03  4.7498e-01         0.6348
2806779  -2.8332e-01 -2.9222e-04  4.8136e-03 -4.0793e+00         0.0000
3074531  -1.3362e-02 -1.7228e-04  2.8383e-03 -2.4757e-01         0.8045
3217865   3.8762e-02 -1.2102e-04  4.1125e-03  6.0633e-01         0.5443
3275949  -9.5145e-04 -1.0282e-04  1.0941e-03 -2.5656e-02         0.9795
3346393   2.2666e-02 -8.2736e-05  8.8039e-04  7.6669e-01         0.4433
3466731  -6.9521e-02 -5.3469e-05  5.6897e-04 -2.9123e+00         0.0036
3480752  -2.2382e-01 -5.0473e-05  1.7152e-03 -5.4031e+00         0.0000
3729148  -1.5010e-03 -1.1714e-05  2.6137e-04 -9.2119e-02         0.9266
3808253  -1.6117e-03 -5.0626e-06  6.5692e-05 -1.9823e-01         0.8429
4019924  -1.2573e-03 -7.8762e-07  1.0220e-05 -3.9303e-01         0.6943
4229538   3.8586e-02 -1.5956e-05  1.4319e-04  3.2259e+00         0.0013
4390001   1.2125e-02 -4.0614e-05  6.6920e-04  4.7028e-01         0.6382
5583809  -2.0145e-02 -5.7928e-04  5.1957e-03 -2.7144e-01         0.7861
5900721  -1.9960e-02 -8.2746e-04  1.3623e-02 -1.6392e-01         0.8698
6759836  -8.4719e-03 -1.7222e-03  3.8363e-02 -3.4461e-02         0.9725
7259669   6.2931e-02 -2.3921e-03  8.1100e-02  2.2938e-01         0.8186
7503461  -1.2533e-01 -2.7586e-03  3.5697e-02 -6.4877e-01         0.5165
7877379  -8.6358e-02 -3.3715e-03  2.3185e-01 -1.7235e-01         0.8632
8292809  -6.5860e-02 -4.1245e-03  4.3711e-02 -2.9528e-01         0.7678
8958499  -5.3648e-03 -5.4893e-03  1.2181e-01  3.5655e-04         0.9997
9618052  -1.1727e-01 -7.0335e-03  9.0625e-02 -3.6617e-01         0.7142
9898428  -4.8310e-02 -7.7478e-03  9.9758e-02 -1.2843e-01         0.8978
11165860 -2.1862e-01 -1.1408e-02  1.4634e-01 -5.4167e-01         0.5880
14576466  0.0000e+00  0.0000e+00  0.0000e+00         NaN            NaN
66966562 -9.6268e-01 -8.7220e-01  1.1862e+00 -8.3076e-02         0.9338</code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  localMI2[fips2,], </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Cov<span class="sc">$</span>value[fips2]),</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..
186279    1.4977e-01 -4.5757e-03  1.0163e-01  4.8415e-01         0.6283
268114    1.4855e-01 -4.2892e-03  9.5297e-02  4.9511e-01         0.6205
293894    2.7163e-01 -4.2009e-03  1.4217e-01  7.3154e-01         0.4645
447336    1.0150e-01 -3.6943e-03  8.2128e-02  3.6707e-01         0.7136
485037    1.5715e-01 -3.5748e-03  5.8693e-02  6.6343e-01         0.5071
529651    1.3358e-01 -3.4359e-03  7.6404e-02  4.9571e-01         0.6201
558942    1.1708e-01 -3.3462e-03  1.1334e-01  3.5769e-01         0.7206
610243   -8.1241e-01 -3.1920e-03  5.2429e-02 -3.5341e+00         0.0004
631278   -3.9756e-02 -3.1298e-03  6.9619e-02 -1.3881e-01         0.8896
635434    7.8666e-02 -3.1176e-03  3.3074e-02  4.4970e-01         0.6529
643783    1.3830e-01 -3.0932e-03  6.8806e-02  5.3904e-01         0.5899
643880    1.0189e-01 -3.0929e-03  5.0806e-02  4.6576e-01         0.6414
726097    9.4663e-02 -2.8571e-03  4.6944e-02  4.5009e-01         0.6526
730298    1.0497e-01 -2.8453e-03  3.6817e-02  5.6190e-01         0.5742
760557   -1.3466e-01 -2.7611e-03  4.5371e-02 -6.1921e-01         0.5358
764080    7.7896e-02 -2.7514e-03  4.5212e-02  3.7929e-01         0.7045
901463    1.6637e-01 -2.3855e-03  3.0881e-02  9.6032e-01         0.3369
903723    1.4625e-01 -2.3797e-03  3.0806e-02  8.4679e-01         0.3971
957642    7.4769e-02 -2.2434e-03  3.6884e-02  4.0100e-01         0.6884
958127   -3.8467e-02 -2.2422e-03  4.9920e-02 -1.6213e-01         0.8712
963442    1.0308e-01 -2.2290e-03  3.6647e-02  5.5010e-01         0.5822
1028626  -2.4265e-01 -2.0702e-03  7.0209e-02 -9.0797e-01         0.3639
1058608   3.9144e-02 -1.9990e-03  3.2874e-02  2.2692e-01         0.8205
1092917   1.5559e-01 -1.9192e-03  6.5099e-02  6.1732e-01         0.5370
1102454   1.2876e-01 -1.8973e-03  4.2255e-02  6.3563e-01         0.5250
1114278   1.0088e-01 -1.8703e-03  1.9866e-02  7.2902e-01         0.4660
1137307  -1.1783e-01 -1.8183e-03  4.0499e-02 -5.7646e-01         0.5643
1178069   1.4082e-01 -1.7281e-03  3.8493e-02  7.2655e-01         0.4675
1249218  -4.2654e-01 -1.5761e-03  1.6746e-02 -3.2840e+00         0.0010
1266191  -1.7550e-01 -1.5408e-03  3.4328e-02 -9.3890e-01         0.3478
1287650   6.0796e-02 -1.4969e-03  3.3350e-02  3.4111e-01         0.7330
1344853  -1.3791e-01 -1.3828e-03  3.0811e-02 -7.7779e-01         0.4367
1375416   8.3621e-02 -1.3237e-03  1.4067e-02  7.1619e-01         0.4739
1412072   1.2440e-01 -1.2545e-03  1.3333e-02  1.0882e+00         0.2765
1429758   3.4411e-03 -1.2217e-03  1.0951e-02  4.4557e-02         0.9645
1714826   8.0151e-02 -7.5400e-04  8.0179e-03  9.0354e-01         0.3662
1717666  -8.2958e-01 -7.4991e-04  2.5467e-02 -5.1937e+00         0.0000
1743469  -1.5951e-02 -7.1322e-04  4.8117e-03 -2.1968e-01         0.8261
1794888   2.8896e-02 -6.4284e-04  4.4328e-02  1.4030e-01         0.8884
1950547   2.3005e-02 -4.5208e-04  1.0083e-02  2.3361e-01         0.8153
1954185  -3.3037e-01 -4.4802e-04  7.3790e-03 -3.8407e+00         0.0001
1975703   3.5177e-02 -4.2439e-04  6.9900e-03  4.2583e-01         0.6702
2121791   1.4472e-03 -2.8091e-04  4.6274e-03  2.5405e-02         0.9797
2125059  -5.6210e-03 -2.7803e-04  3.6068e-03 -8.8966e-02         0.9291
2191069  -2.4944e-02 -2.2317e-04  4.9786e-03 -3.5036e-01         0.7261
2202302  -5.2797e-02 -2.1444e-04  2.7820e-03 -9.9694e-01         0.3188
2296231   2.3730e-02 -1.4821e-04  2.4418e-03  4.8321e-01         0.6289
2313341   1.1953e-02 -1.3746e-04  1.4627e-03  3.1614e-01         0.7519
2562979  -1.2428e-02 -2.6643e-05  4.3900e-04 -5.9190e-01         0.5539
2574410   2.0706e-02 -2.3631e-05  8.0307e-04  7.3152e-01         0.4645
2628493  -3.5879e-02 -1.1829e-05  1.0616e-04 -3.4811e+00         0.0005
2795676   3.3440e-03 -9.1358e-07  1.5054e-05  8.6210e-01         0.3886
2955958  -1.3162e-02 -2.6724e-05  2.8438e-04 -7.7891e-01         0.4360
3129404   1.1563e-02 -9.4660e-05  1.0073e-03  3.6733e-01         0.7134
3186397  -1.3556e-02 -1.2606e-04  1.6356e-03 -3.3208e-01         0.7398
3208356  -1.6498e-02 -1.3936e-04  1.8081e-03 -3.8472e-01         0.7004
3220463   1.0341e-01 -1.4697e-04  1.5638e-03  2.6188e+00         0.0088
3563101   4.5578e-02 -4.4652e-04  9.9589e-03  4.6120e-01         0.6447
3624677  -6.0288e-02 -5.1755e-04  6.7123e-03 -7.2954e-01         0.4657
4308052   1.5086e-04 -1.6577e-03  1.4853e-02  1.4840e-02         0.9882
4483861  -5.1671e-02 -2.0555e-03  1.4154e-01 -1.3188e-01         0.8951
5151594   0.0000e+00  0.0000e+00  0.0000e+00         NaN            NaN
5893753  -1.0232e-01 -6.7902e-03  7.1769e-02 -3.5660e-01         0.7214
6786057   3.5076e-01 -1.1206e-02  3.7658e-01  5.8985e-01         0.5553
8267488   2.5037e-01 -2.0969e-02  4.5808e-01  4.0090e-01         0.6885
9159438  -9.1370e-02 -2.8310e-02  3.5695e-01 -1.0555e-01         0.9159
9741769  -3.2122e-01 -3.3696e-02  4.2251e-01 -4.4234e-01         0.6582
10183515 -2.3254e-01 -3.8094e-02  4.7549e-01 -2.8199e-01         0.7779
36189756 -1.3553e+00 -7.7241e-01  1.8708e+00 -4.2615e-01         0.6700</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  localMI3[fips3,], </span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Post<span class="sc">$</span>value[fips3]),</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..
266636    1.5948e-01 -4.2080e-03  9.3500e-02  5.3533e-01         0.5924
303943    1.5471e-01 -4.1130e-03  9.1399e-02  5.2534e-01         0.5993
499251    2.2229e-01 -3.6335e-03  1.2304e-01  6.4410e-01         0.5195
505141    1.7158e-01 -3.6195e-03  5.9425e-02  7.1871e-01         0.4723
596906    1.4525e-01 -3.4048e-03  5.5913e-02  6.2866e-01         0.5296
623031    4.1354e-02 -3.3449e-03  1.1330e-01  1.3280e-01         0.8944
723948    7.1234e-02 -3.1185e-03  6.9368e-02  2.8230e-01         0.7777
729046   -8.4343e-01 -3.1073e-03  5.1042e-02 -3.7195e+00         0.0002
772355    9.9412e-02 -3.0127e-03  3.1964e-02  5.7289e-01         0.5667
787364    1.8875e-01 -2.9803e-03  3.8558e-02  9.7644e-01         0.3288
802427    9.2773e-02 -2.9479e-03  4.8432e-02  4.3495e-01         0.6636
811692    9.6269e-02 -2.9281e-03  4.8107e-02  4.5226e-01         0.6511
833616   -1.0910e-01 -2.8815e-03  6.4110e-02 -4.1949e-01         0.6749
840680    1.0348e-01 -2.8665e-03  6.3779e-02  4.2109e-01         0.6737
928246    1.1791e-01 -2.6845e-03  3.4740e-02  6.4701e-01         0.5176
1060991  -1.4702e-01 -2.4198e-03  3.9777e-02 -7.2503e-01         0.4684
1065152   1.8859e-01 -2.4118e-03  8.1767e-02  6.6794e-01         0.5042
1108082   1.1066e-01 -2.3293e-03  3.8291e-02  5.7742e-01         0.5637
1136193   1.1468e-01 -2.2760e-03  2.4166e-02  7.5234e-01         0.4518
1174838   4.6712e-02 -2.2038e-03  3.6234e-02  2.5698e-01         0.7972
1197923   1.0428e-01 -2.1613e-03  3.5536e-02  5.6467e-01         0.5723
1250998  -7.4191e-02 -2.0650e-03  4.5981e-02 -3.3636e-01         0.7366
1277641  -1.7536e-01 -2.0175e-03  6.8425e-02 -6.6269e-01         0.5075
1307282   1.2684e-01 -1.9652e-03  4.3765e-02  6.1569e-01         0.5381
1333122  -8.1113e-02 -1.9203e-03  4.2766e-02 -3.8294e-01         0.7018
1333727  -1.2730e-01 -1.9192e-03  4.2743e-02 -6.0645e-01         0.5442
1353386  -8.0507e-02 -1.8854e-03  4.1990e-02 -3.8368e-01         0.7012
1450068   1.2048e-01 -1.7233e-03  2.2324e-02  8.1791e-01         0.4134
1637010   8.5833e-02 -1.4306e-03  9.8572e-02  2.7794e-01         0.7811
1655891   1.1606e-01 -1.4026e-03  3.1252e-02  6.6445e-01         0.5064
1807239  -6.2648e-02 -1.1878e-03  1.9548e-02 -4.3958e-01         0.6602
1850577   7.0661e-02 -1.1295e-03  1.2007e-02  6.5517e-01         0.5124
1862579   2.4540e-02 -1.1137e-03  1.8330e-02  1.8948e-01         0.8497
1879713   3.6228e-03 -1.0912e-03  9.7824e-03  4.7662e-02         0.9620
1882216   8.8870e-02 -1.0880e-03  2.4250e-02  5.7768e-01         0.5635
1890089   7.6348e-02 -1.0777e-03  2.4022e-02  4.9955e-01         0.6174
1946338   1.0824e-01 -1.0061e-03  1.0696e-02  1.0563e+00         0.2908
1949733  -3.6585e-01 -1.0018e-03  1.0651e-02 -3.5353e+00         0.0004
2007300  -1.3891e-01 -9.3120e-04  1.2072e-02 -1.2558e+00         0.2092
2058450   1.0037e-02 -8.7061e-04  1.1287e-02  1.0267e-01         0.9182
2070309  -1.1868e-02 -8.5685e-04  5.7799e-03 -1.4483e-01         0.8848
2132844   8.1610e-02 -7.8612e-04  8.3592e-03  9.0121e-01         0.3675
2263922   2.4856e-02 -6.4775e-04  1.4444e-02  2.1220e-01         0.8319
2571747   2.7740e-02 -3.7542e-04  4.8696e-03  4.0290e-01         0.6870
2607259   3.5036e-02 -3.4875e-04  5.7446e-03  4.6687e-01         0.6406
2712550   2.8804e-02 -2.7545e-04  2.9305e-03  5.3717e-01         0.5911
2713186   7.0501e-02 -2.7504e-04  9.3446e-03  7.3216e-01         0.4641
2911924  -3.9591e-01 -1.6033e-04  5.4478e-03 -5.3618e+00         0.0000
3101583  -1.4678e-01 -7.9547e-05  1.3106e-03 -4.0521e+00         0.0001
3137805   2.3058e-02 -6.7306e-05  7.1621e-04  8.6413e-01         0.3875
3461450   5.3107e-03 -3.2999e-06  4.2820e-05  8.1209e-01         0.4167
3480829  -1.5869e-02 -2.0567e-06  1.8457e-05 -3.6932e+00         0.0002
3543982   4.2599e-04 -3.5239e-08  2.4315e-06  2.7321e-01         0.7847
3872425  -1.0659e-02 -3.9620e-05  5.1409e-04 -4.6834e-01         0.6395
4170030  -1.4425e-02 -1.4806e-04  1.3285e-03 -3.9168e-01         0.6953
4707688  -5.6720e-02 -5.1889e-04  8.5456e-03 -6.0796e-01         0.5432
4746547   5.2200e-02 -5.5442e-04  9.1304e-03  5.5209e-01         0.5809
4842579   4.8323e-02 -6.4726e-04  6.8836e-03  5.9023e-01         0.5550
5508086   3.1701e-01 -1.4881e-03  1.5812e-02  2.5328e+00         0.0113
5626923   5.2899e-02 -1.6745e-03  3.7302e-02  2.8256e-01         0.7775
6262555   7.7713e-02 -2.8586e-03  6.3603e-02  3.1948e-01         0.7494
7412807   0.0000e+00  0.0000e+00  0.0000e+00         NaN            NaN
7427535  -9.1518e-02 -5.8458e-03  7.5412e-02 -3.1198e-01         0.7551
9637081  -6.3542e-02 -1.4416e-02  1.5120e-01 -1.2634e-01         0.8995
10813847  5.6402e-01 -2.0532e-02  4.4873e-01  8.7263e-01         0.3829
10855074 -1.9045e-01 -2.0766e-02  2.6386e-01 -3.3033e-01         0.7412
11825310  5.5218e-01 -2.6651e-02  8.8161e-01  6.1647e-01         0.5376
14076183 -2.3999e-01 -4.3129e-02  5.3551e-01 -2.6902e-01         0.7879
48196182 -7.1729e-01 -7.7628e-01  1.8482e+00  4.3387e-02         0.9654</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="mapping-the-local-morans-i" class="level4">
<h4 class="anchored" data-anchor-id="mapping-the-local-morans-i">Mapping the local Moran’s I</h4>
<p>Before mapping the local Moran’s I map, it is wise to append the local Moran’s I dataframe</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>Pre.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Pre,localMI1) <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>Cov.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Cov,localMI2) <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>Post.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Post,localMI3) <span class="sc">%&gt;%</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping-local-morans-i-values" class="level4">
<h4 class="anchored" data-anchor-id="mapping-local-morans-i-values">Mapping local Moran’s I values</h4>
<p>Using choropleth mapping functions of <strong>tmap</strong> package, we can plot the local Moran’s I values by using the code chinks below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Pre.localMI) <span class="sc">+</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Cov.localMI) <span class="sc">+</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Post.localMI) <span class="sc">+</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping-local-morans-i-p-values" class="level4">
<h4 class="anchored" data-anchor-id="mapping-local-morans-i-p-values">Mapping local Moran’s I p-values</h4>
<p>The choropleth shows there is evidence for both positive and negative Ii values. However, it is useful to consider the p-values for each of these values, as consider above.</p>
<p>The code chunks below produce a choropleth map of Moran’s I p-values by using functions of <strong>tmap</strong> package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Pre.localMI) <span class="sc">+</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Cov.localMI) <span class="sc">+</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Post.localMI) <span class="sc">+</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="creating-a-lisa-cluster-map" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-lisa-cluster-map"><strong>Creating a LISA Cluster Map</strong></h2>
<p>The LISA Cluster Map shows the significant locations color coded by type of spatial autocorrelation. The first step before we can generate the LISA cluster map is to plot the Moran scatterplot.</p>
<section id="plotting-moran-scatterplot" class="level3">
<h3 class="anchored" data-anchor-id="plotting-moran-scatterplot"><strong>Plotting Moran scatterplot</strong></h3>
<p>The Moran scatterplot is an illustration of the relationship between the values of the chosen attribute at each location and the average value of the same attribute at neighboring locations.</p>
<p>The code chunk below plots the Moran scatterplot of Tourism by using <a href="https://r-spatial.github.io/spdep/reference/moran.plot.html"><em>moran.plot()</em></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>ncipre <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Pre<span class="sc">$</span>value, rswm_qlocal1,</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Pre<span class="sc">$</span>province_eng), </span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Tourists"</span>, </span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Spatially Lag tourists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>ncicov <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Cov<span class="sc">$</span>value, rswm_qlocal2,</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Cov<span class="sc">$</span>province_eng), </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Tourists"</span>, </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Spatially Lag tourists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>ncipost <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Post<span class="sc">$</span>value, rswm_qlocal3,</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Post<span class="sc">$</span>province_eng), </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Tourists"</span>, </span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Spatially Lag tourists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Notice that the plots are split in 4 quadrants. The top right corner belongs to areas that have high tourism numbers and are surrounded by other areas that have the average level of toursism.</p>
</section>
<section id="preparing-lisa-map-classes" class="level3">
<h3 class="anchored" data-anchor-id="preparing-lisa-map-classes"><strong>Preparing LISA map classes</strong></h3>
<p>The code chunks below show the steps to prepare a LISA cluster map.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>quadrantpre <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI1))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>Pre<span class="sc">$</span>lag_value <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_qlocal1, Pre<span class="sc">$</span>value)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>DV1 <span class="ot">&lt;-</span> Pre<span class="sc">$</span>lag_value <span class="sc">-</span> <span class="fu">mean</span>(Pre<span class="sc">$</span>lag_value)     </span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>LM_IPre <span class="ot">&lt;-</span> localMI1[,<span class="dv">1</span>]   </span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>quadrantpre[localMI1[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>quadrantcov <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI2))</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>Cov<span class="sc">$</span>lag_value <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_qlocal2, Cov<span class="sc">$</span>value)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>DV2 <span class="ot">&lt;-</span> Cov<span class="sc">$</span>lag_value <span class="sc">-</span> <span class="fu">mean</span>(Cov<span class="sc">$</span>lag_value)     </span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>LM_ICov <span class="ot">&lt;-</span> localMI2[,<span class="dv">1</span>]   </span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>quadrantcov[localMI2[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>quadrantpost <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI3))</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>Post<span class="sc">$</span>lag_value <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_qlocal3, Post<span class="sc">$</span>value)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>DV3 <span class="ot">&lt;-</span> Post<span class="sc">$</span>lag_value <span class="sc">-</span> <span class="fu">mean</span>(Post<span class="sc">$</span>lag_value)     </span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>LM_IPost <span class="ot">&lt;-</span> localMI3[,<span class="dv">1</span>]   </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>quadrantpost[localMI3[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="plotting-lisa-map" class="level3">
<h3 class="anchored" data-anchor-id="plotting-lisa-map"><strong>Plotting LISA map</strong></h3>
<p>Now, we can build the LISA map by using the code chunks below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>Pre.localMI<span class="sc">$</span>quadrantpre <span class="ot">&lt;-</span> quadrantpre</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Pre.localMI) <span class="sc">+</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrantpre"</span>, </span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpre)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpre)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>Cov.localMI<span class="sc">$</span>quadrantcov <span class="ot">&lt;-</span> quadrantcov</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Cov.localMI) <span class="sc">+</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrantcov"</span>, </span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantcov)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantcov)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>Post.localMI<span class="sc">$</span>quadrantpost <span class="ot">&lt;-</span> quadrantpost</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Post.localMI) <span class="sc">+</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrantpost"</span>, </span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpost)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpost)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="hot-spot-and-cold-spot-area-analysis" class="level1">
<h1><strong>Hot Spot and Cold Spot Area Analysis</strong></h1>
<p>Beside detecting cluster and outliers, localised spatial statistics can be also used to detect hot spot and/or cold spot areas.</p>
<p>The term ‘hot spot’ has been used generically across disciplines to describe a region or value that is higher relative to its surroundings (Lepers et al 2005, Aben et al 2012, Isobe et al 2015).</p>
<section id="getis-and-ords-g-statistics" class="level3">
<h3 class="anchored" data-anchor-id="getis-and-ords-g-statistics"><strong>Getis and Ord’s G-Statistics</strong></h3>
<p>An alternative spatial statistics to detect spatial anomalies is the Getis and Ord’s G-statistics (Getis and Ord, 1972; Ord and Getis, 1995). It looks at neighbours within a defined proximity to identify where either high or low values clutser spatially. Here, statistically significant hot-spots are recognised as areas of high values where other areas within a neighbourhood range also share high values too.</p>
<p>The analysis consists of three steps:</p>
<ul>
<li><p>Deriving spatial weight matrix</p></li>
<li><p>Computing Gi statistics</p></li>
<li><p>Mapping Gi statistics</p></li>
</ul>
</section>
<section id="deriving-distance-based-weight-matrix" class="level3">
<h3 class="anchored" data-anchor-id="deriving-distance-based-weight-matrix"><strong>Deriving distance-based weight matrix</strong></h3>
<p>First, we need to define a new set of neighbours. Whist the spatial autocorrelation considered units which shared borders, for Getis-Ord we are defining neighbours based on distance.</p>
<p>There are two type of distance-based proximity matrix, they are:</p>
<ul>
<li><p>fixed distance weight matrix; and</p></li>
<li><p>adaptive distance weight matrix.</p></li>
</ul>
<section id="deriving-the-centroid" class="level4">
<h4 class="anchored" data-anchor-id="deriving-the-centroid">Deriving the centroid</h4>
<p>We will need points to associate with each polygon before we can make our connectivity graph. It will be a little more complicated than just running <em>st_centroid()</em> on the sf object: <strong>us.bound</strong>. We need the coordinates in a separate data frame for this to work. To do this we will use a mapping function. The mapping function applies a given function to each element of a vector and returns a vector of the same length. Our input vector will be the geometry column of us.bound. Our function will be <em>st_centroid()</em>. We will be using map_dbl variation of map from the purrr package. For more documentation, check out map documentation</p>
<p>To get our longitude values we map the <em>st_centroid()</em> function over the geometry column of us.bound and access the longitude value through double bracket notation [[]] and 1. This allows us to get only the longitude, which is the first value in each centroid.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>longitude1 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Pre<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for latitude with one key difference. We access the second value per each centroid with [[2]].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>latitude1 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Pre<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>coords1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude1, latitude1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>longitude2 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Cov<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for latitude with one key difference. We access the second value per each centroid with [[2]].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>latitude2 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Cov<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>coords2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude2, latitude2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>longitude3 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Post<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for latitude with one key difference. We access the second value per each centroid with [[2]].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>latitude3 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Post<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>coords3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude3, latitude3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="determine-the-cut-off-distance" class="level4">
<h4 class="anchored" data-anchor-id="determine-the-cut-off-distance">Determine the cut-off distance</h4>
<p>Firstly, we need to determine the upper limit for distance band by using the steps below:</p>
<ul>
<li><p>Return a matrix with the indices of points belonging to the set of the k nearest neighbours of each other by using <a href="https://r-spatial.github.io/spdep/reference/knearneigh.html"><em>knearneigh()</em></a> of <strong>spdep</strong>.</p></li>
<li><p>Convert the knn object returned by <em>knearneigh()</em> into a neighbours list of class nb with a list of integer vectors containing neighbour region number ids by using <a href="https://r-spatial.github.io/spdep/reference/knn2nb.html"><em>knn2nb()</em></a>.</p></li>
<li><p>Return the length of neighbour relationship edges by using <a href="https://r-spatial.github.io/spdep/reference/nbdists.html"><em>nbdists()</em></a> of <strong>spdep</strong>. The function returns in the units of the coordinates if the coordinates are projected, in km otherwise.</p></li>
<li><p>Remove the list structure of the returned object by using <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/unlist"><strong>unlist()</strong></a>.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>k1pre <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords1)): neighbour object has 18 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>k1distspre <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1pre, coords1, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1distspre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   52.52   69.06   66.79   77.42  124.72 </code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>k1cov <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords2)): neighbour object has 18 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>k1distscov <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1cov, coords2, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1distscov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   52.52   69.06   66.79   77.42  124.72 </code></pre>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>k1post <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords3)): neighbour object has 18 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>k1distspost <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1post, coords3, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1distspost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   52.52   69.06   66.79   77.42  124.72 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The summary report shows that the largest first nearest neighbour distance is 61.79 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour.</p>
</section>
<section id="computing-fixed-distance-weight-matrix" class="level4">
<h4 class="anchored" data-anchor-id="computing-fixed-distance-weight-matrix">Computing fixed distance weight matrix</h4>
<p>Now, we will compute the distance weight matrix by using <a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html"><em>dnearneigh()</em></a> as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>wm_d53 <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords1, <span class="dv">0</span>, <span class="dv">53</span>, <span class="at">longlat =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dnearneigh(coords1, 0, 53, longlat = TRUE): neighbour object has 55
sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>wm_d53</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 40 
Percentage nonzero weights: 0.8401596 
Average number of links: 0.5797101 
51 regions with no links:
9, 10, 11, 12, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29,
30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
48, 50, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 67, 68, 69
55 disjoint connected subgraphs</code></pre>
</div>
</div>
<p>Next,&nbsp;<em>nb2listw()</em>&nbsp;is used to convert the nb object into spatial weights object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>wm53_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_d53, <span class="at">style =</span> <span class="st">'B'</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm53_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 40 
Percentage nonzero weights: 0.8401596 
Average number of links: 0.5797101 
51 regions with no links:
9, 10, 11, 12, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29,
30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
48, 50, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 67, 68, 69
55 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  6 
51  9  2  3  3  1 
9 least connected regions:
7 8 13 18 20 49 51 65 66 with 1 link
1 most connected region:
3 with 6 links

Weights style: B 
Weights constants summary:
   n  nn S0 S1  S2
B 18 324 40 80 512</code></pre>
</div>
</div>
<p>The output spatial weights object is called <code>wm53_lw</code>.</p>
</section>
</section>
<section id="computing-adaptive-distance-weight-matrix" class="level3">
<h3 class="anchored" data-anchor-id="computing-adaptive-distance-weight-matrix"><strong>Computing adaptive distance weight matrix</strong></h3>
<p>One of the characteristics of fixed distance weight matrix is that more densely settled areas (usually the urban areas) tend to have more neighbours and the less densely settled areas (usually the rural counties) tend to have lesser neighbours. Having many neighbours smoothes the neighbour relationship across more neighbours.</p>
<p>It is possible to control the numbers of neighbours directly using k-nearest neighbours, either accepting asymmetric neighbours or imposing symmetry as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>knn <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords1, <span class="at">k=</span><span class="dv">8</span>))</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>knn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 552 
Percentage nonzero weights: 11.5942 
Average number of links: 8 
Non-symmetric neighbours list</code></pre>
</div>
</div>
<p>Next,&nbsp;<em>nb2listw()</em>&nbsp;is used to convert the nb object into spatial weights object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>knn_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(knn_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 552 
Percentage nonzero weights: 11.5942 
Average number of links: 8 
Non-symmetric neighbours list
Link number distribution:

 8 
69 
69 least connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 with 8 links
69 most connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 with 8 links

Weights style: B 
Weights constants summary:
   n   nn  S0  S1    S2
B 69 4761 552 972 18472</code></pre>
</div>
</div>
</section>
<section id="computing-gi-statistics" class="level2">
<h2 class="anchored" data-anchor-id="computing-gi-statistics"><strong>Computing Gi statistics</strong></h2>
<section id="gi-statistics-using-fixed-distance" class="level3">
<h3 class="anchored" data-anchor-id="gi-statistics-using-fixed-distance"><strong>Gi statistics using fixed distance</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>fips11 <span class="ot">&lt;-</span> <span class="fu">order</span>(Pre<span class="sc">$</span>province_eng)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>gi.fixedPre <span class="ot">&lt;-</span> <span class="fu">localG</span>(Pre<span class="sc">$</span>value, wm53_lw)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>gi.fixedCov <span class="ot">&lt;-</span> <span class="fu">localG</span>(Cov<span class="sc">$</span>value, wm53_lw)</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>gi.fixedPost <span class="ot">&lt;-</span> <span class="fu">localG</span>(Post<span class="sc">$</span>value, wm53_lw)</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>gi.fixedPre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.383057414  4.267428706  3.231730034  4.073612615 -0.422558627
 [6]  0.009110214 -0.386499267 -0.106684353          NaN          NaN
[11]          NaN          NaN  0.050594690          NaN          NaN
[16]          NaN          NaN -0.449803957          NaN -0.412179654
[21]          NaN          NaN          NaN          NaN          NaN
[26]          NaN          NaN          NaN          NaN          NaN
[31]          NaN          NaN          NaN          NaN          NaN
[36]          NaN          NaN          NaN          NaN          NaN
[41]          NaN          NaN          NaN          NaN          NaN
[46]          NaN          NaN          NaN -0.231812957          NaN
[51] -0.381217592 -0.310346441  3.732782576 -0.357109083          NaN
[56]          NaN          NaN          NaN          NaN          NaN
[61]          NaN          NaN          NaN          NaN -0.287656830
[66] -0.295132454          NaN          NaN          NaN
attr(,"internals")
               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))
 [1,] 0.048128995 0.05882353 0.0007794639 -0.383057414   7.016772e-01
 [2,] 0.266524054 0.04411765 0.0027162019  4.267428706   1.977389e-05
 [3,] 0.320259915 0.08823529 0.0051546359  3.231730034   1.230432e-03
 [4,] 0.300779496 0.05882353 0.0035278752  4.073612615   4.628945e-05
 [5,] 0.021740826 0.04411765 0.0028042895 -0.422558627   6.726173e-01
 [6,] 0.044587328 0.04411765 0.0026579656  0.009110214   9.927312e-01
 [7,] 0.003038722 0.01470588 0.0009112405 -0.386499267   6.991269e-01
 [8,] 0.011435713 0.01470588 0.0009395915 -0.106684353   9.150394e-01
 [9,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[10,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[11,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[12,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[13,] 0.016249096 0.01470588 0.0009303414  0.050594690   9.596485e-01
[14,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[15,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[16,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[17,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[18,] 0.001125102 0.01470588 0.0009115971 -0.449803957   6.528518e-01
[19,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[20,] 0.002278466 0.01470588 0.0009090518 -0.412179654   6.802077e-01
[21,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[22,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[23,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[24,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[25,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[26,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[27,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[28,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[29,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[30,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[31,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[32,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[33,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[34,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[35,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[36,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[37,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[38,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[39,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[40,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[41,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[42,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[43,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[44,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[45,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[46,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[47,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[48,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[49,] 0.007656099 0.01470588 0.0009248603 -0.231812957   8.166833e-01
[50,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[51,] 0.003069095 0.01470588 0.0009317949 -0.381217592   7.030418e-01
[52,] 0.016066964 0.02941176 0.0018489734 -0.310346441   7.562975e-01
[53,] 0.279974868 0.05882353 0.0035100537  3.732782576   1.893761e-04
[54,] 0.014184071 0.02941176 0.0018183039 -0.357109083   7.210101e-01
[55,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[56,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[57,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[58,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[59,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[60,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[61,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[62,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[63,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[64,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[65,] 0.005985470 0.01470588 0.0009190193 -0.287656830   7.736094e-01
[66,] 0.005756492 0.01470588 0.0009195026 -0.295132454   7.678927e-01
[67,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[68,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[69,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
attr(,"cluster")
 [1] High Low  Low  Low  High Low  Low  High High Low  Low  Low  Low  Low  High
[16] Low  Low  Low  Low  Low  Low  High High Low  Low  Low  Low  Low  Low  Low 
[31] Low  High Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[46] Low  Low  Low  Low  High Low  High Low  Low  High High Low  High High High
[61] Low  Low  High Low  Low  Low  Low  Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Pre$value, listw = wm53_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>gi.fixedCov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.816848955  3.920841383  2.892474453  3.815650816 -0.544925844
 [6]  0.138811924 -0.466157899 -0.042139523          NaN          NaN
[11]          NaN          NaN  0.007203213          NaN          NaN
[16]          NaN          NaN -0.544307566          NaN -0.498406047
[21]          NaN          NaN          NaN          NaN          NaN
[26]          NaN          NaN          NaN          NaN          NaN
[31]          NaN          NaN          NaN          NaN          NaN
[36]          NaN          NaN          NaN          NaN          NaN
[41]          NaN          NaN          NaN          NaN          NaN
[46]          NaN          NaN          NaN -0.124070083          NaN
[51] -0.456829251 -0.453549943  3.506725387 -0.417523654          NaN
[56]          NaN          NaN          NaN          NaN          NaN
[61]          NaN          NaN          NaN          NaN -0.372132305
[66] -0.393517670          NaN          NaN          NaN
attr(,"internals")
               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))
 [1,] 0.035870272 0.05882353 0.0007895964 -0.816848955   4.140148e-01
 [2,] 0.208788081 0.04411765 0.0017638949  3.920841383   8.824033e-05
 [3,] 0.256258942 0.08823529 0.0033744403  2.892474453   3.822203e-03
 [4,] 0.241907832 0.05882353 0.0023023162  3.815650816   1.358245e-04
 [5,] 0.020784265 0.04411765 0.0018334986 -0.544925844   5.858045e-01
 [6,] 0.049907291 0.04411765 0.0017396030  0.138811924   8.895988e-01
 [7,] 0.003323466 0.01470588 0.0005962149 -0.466157899   6.411025e-01
 [8,] 0.013662131 0.01470588 0.0006135010 -0.042139523   9.663875e-01
 [9,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[10,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[11,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[12,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[13,] 0.014884075 0.01470588 0.0006119661  0.007203213   9.942527e-01
[14,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[15,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[16,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[17,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[18,] 0.001411810 0.01470588 0.0005965232 -0.544307566   5.862298e-01
[19,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[20,] 0.002551150 0.01470588 0.0005947360 -0.498406047   6.181979e-01
[21,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[22,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[23,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[24,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[25,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[26,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[27,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[28,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[29,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[30,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[31,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[32,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[33,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[34,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[35,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[36,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[37,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[38,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[39,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[40,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[41,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[42,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[43,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[44,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[45,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[46,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[47,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[48,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[49,] 0.011642813 0.01470588 0.0006095081 -0.124070083   9.012598e-01
[50,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[51,] 0.003371066 0.01470588 0.0006156319 -0.456829251   6.477938e-01
[52,] 0.013657683 0.02941176 0.0012065240 -0.453549943   6.501528e-01
[53,] 0.226382553 0.05882353 0.0022831378  3.506725387   4.536571e-04
[54,] 0.014944295 0.02941176 0.0012006682 -0.417523654   6.762954e-01
[55,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[56,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[57,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[58,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[59,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[60,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[61,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[62,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[63,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[64,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[65,] 0.005588228 0.01470588 0.0006003043 -0.372132305   7.097943e-01
[66,] 0.005057940 0.01470588 0.0006010919 -0.393517670   6.939372e-01
[67,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[68,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
[69,] 0.000000000 0.00000000 0.0000000000          NaN            NaN
attr(,"cluster")
 [1] High Low  Low  Low  High Low  Low  High High Low  Low  High Low  Low  High
[16] Low  Low  Low  Low  Low  Low  High High Low  Low  Low  Low  Low  Low  Low 
[31] Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low  Low  Low 
[46] High Low  Low  Low  High High Low  Low  Low  High High High Low  High Low 
[61] Low  Low  High Low  Low  Low  Low  Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Cov$value, listw = wm53_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>gi.fixedPost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.5060001  4.0307500  3.1228883  4.0965665 -0.4299503  0.4194876
 [7] -0.4468523 -0.2793733        NaN        NaN        NaN        NaN
[13]  0.1887167        NaN        NaN        NaN        NaN -0.5392547
[19]        NaN -0.5013670        NaN        NaN        NaN        NaN
[25]        NaN        NaN        NaN        NaN        NaN        NaN
[31]        NaN        NaN        NaN        NaN        NaN        NaN
[37]        NaN        NaN        NaN        NaN        NaN        NaN
[43]        NaN        NaN        NaN        NaN        NaN        NaN
[49]  0.3314706        NaN -0.4365107 -0.3773705  3.8100725 -0.4964776
[55]        NaN        NaN        NaN        NaN        NaN        NaN
[61]        NaN        NaN        NaN        NaN -0.4505550 -0.3876817
[67]        NaN        NaN        NaN
attr(,"internals")
               Gi      E(Gi)        V(Gi)      Z(Gi) Pr(z != E(Gi))
 [1,] 0.044124426 0.05882353 0.0008438795 -0.5060001   6.128566e-01
 [2,] 0.219777478 0.04411765 0.0018992109  4.0307500   5.559916e-05
 [3,] 0.276363910 0.08823529 0.0036290823  3.1228883   1.790857e-03
 [4,] 0.262483231 0.05882353 0.0024715545  4.0965665   4.193230e-05
 [5,] 0.024983369 0.04411765 0.0019805589 -0.4299503   6.672318e-01
 [6,] 0.062218722 0.04411765 0.0018619607  0.4194876   6.748598e-01
 [7,] 0.003409931 0.01470588 0.0006390248 -0.4468523   6.549817e-01
 [8,] 0.007516241 0.01470588 0.0006622843 -0.2793733   7.799583e-01
 [9,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[10,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[11,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[12,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[13,] 0.019502311 0.01470588 0.0006459747  0.1887167   8.503149e-01
[14,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[15,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[16,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[17,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[18,] 0.001089707 0.01470588 0.0006375619 -0.5392547   5.897111e-01
[19,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[20,] 0.002062436 0.01470588 0.0006359449 -0.5013670   6.161129e-01
[21,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[22,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[23,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[24,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[25,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[26,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[27,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[28,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[29,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[30,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[31,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[32,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[33,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[34,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[35,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[36,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[37,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[38,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[39,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[40,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[41,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[42,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[43,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[44,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[45,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[46,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[47,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[48,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[49,] 0.023138564 0.01470588 0.0006472042  0.3314706   7.402890e-01
[50,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[51,] 0.003468364 0.01470588 0.0006627521 -0.4365107   6.624663e-01
[52,] 0.015848022 0.02941176 0.0012918831 -0.3773705   7.058983e-01
[53,] 0.247095716 0.05882353 0.0024417762  3.8100725   1.389261e-04
[54,] 0.011422185 0.02941176 0.0013129335 -0.4964776   6.195575e-01
[55,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[56,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[57,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[58,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[59,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[60,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[61,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[62,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[63,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[64,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[65,] 0.003288728 0.01470588 0.0006421259 -0.4505550   6.523103e-01
[66,] 0.004901713 0.01470588 0.0006395447 -0.3876817   6.982516e-01
[67,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[68,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
[69,] 0.000000000 0.00000000 0.0000000000        NaN            NaN
attr(,"cluster")
 [1] High Low  Low  Low  High Low  Low  High Low  Low  Low  High Low  Low  High
[16] Low  Low  Low  Low  Low  Low  High High Low  Low  Low  Low  Low  Low  Low 
[31] Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low  Low  Low 
[46] Low  Low  Low  Low  High High Low  Low  High High High Low  Low  High High
[61] Low  Low  Low  Low  Low  Low  Low  Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Post$value, listw = wm53_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
</div>
<p>The output of localG() is a vector of G or Gstar values, with attributes “gstari” set to TRUE or FALSE, “call” set to the function call, and class “localG”.</p>
<p>The Gi statistics is represented as a Z-score. Greater values represent a greater intensity of clustering and the direction (positive or negative) indicates high or low clusters.</p>
<p>Next, we will join the Gi values to their corresponding tourism sf data frame by using the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>Pre.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Pre, <span class="fu">as.matrix</span>(gi.fixedPre)) <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixedPre.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>Cov.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Cov, <span class="fu">as.matrix</span>(gi.fixedCov)) <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixedCov.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>Post.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Post, <span class="fu">as.matrix</span>(gi.fixedPost)) <span class="sc">%&gt;%</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixedPost.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>In fact, the code chunk above performs three tasks. First, it convert the output vector (i.e.&nbsp;<em>gi.fixed</em>) into r matrix object by using <em>as.matrix()</em>.</p>
</section>
<section id="mapping-gi-values-with-fixed-distance-weights" class="level3">
<h3 class="anchored" data-anchor-id="mapping-gi-values-with-fixed-distance-weights"><strong>Mapping Gi values with fixed distance weights</strong></h3>
<p>The code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>TourismPre <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Pre, <span class="st">"value"</span>)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>Gimap1 <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Pre.gi) <span class="sc">+</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TourismPre, Gimap1, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_fixed" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>TourismCov <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Cov, <span class="st">"value"</span>)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>Gimap2 <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Cov.gi) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TourismCov, Gimap2, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_fixed" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>TourismPost <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Post, <span class="st">"value"</span>)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>Gimap3 <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Post.gi) <span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(TourismPost, Gimap3, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_fixed" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gi-statistics-using-adaptive-distance" class="level3">
<h3 class="anchored" data-anchor-id="gi-statistics-using-adaptive-distance"><strong>Gi statistics using adaptive distance</strong></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>fips1 <span class="ot">&lt;-</span> <span class="fu">order</span>(Pre<span class="sc">$</span>province_eng)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive1 <span class="ot">&lt;-</span> <span class="fu">localG</span>(Pre<span class="sc">$</span>value, knn_lw)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>Pre.gi1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Pre, <span class="fu">as.matrix</span>(gi.adaptive1)) <span class="sc">%&gt;%</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive1.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>fips2 <span class="ot">&lt;-</span> <span class="fu">order</span>(Cov<span class="sc">$</span>province_eng)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive2 <span class="ot">&lt;-</span> <span class="fu">localG</span>(Cov<span class="sc">$</span>value, knn_lw)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>Cov.gi2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Cov, <span class="fu">as.matrix</span>(gi.adaptive2)) <span class="sc">%&gt;%</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive2.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>fips3 <span class="ot">&lt;-</span> <span class="fu">order</span>(Post<span class="sc">$</span>province_eng)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive3 <span class="ot">&lt;-</span> <span class="fu">localG</span>(Post<span class="sc">$</span>value, knn_lw)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>Post.gi3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Post, <span class="fu">as.matrix</span>(gi.adaptive3)) <span class="sc">%&gt;%</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive3.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping-gi-values-with-adaptive-distance-weights" class="level3">
<h3 class="anchored" data-anchor-id="mapping-gi-values-with-adaptive-distance-weights"><strong>Mapping Gi values with adaptive distance weights</strong></h3>
<p>It is time for us to visualise the locations of hot spot and cold spot areas. The choropleth mapping functions of <strong>tmap</strong> package will be used to map the Gi values.</p>
<p>The code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>Gimap1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre.gi1) <span class="sc">+</span> </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>Gimap2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov.gi2) <span class="sc">+</span> </span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a>Gimap3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post.gi3) <span class="sc">+</span> </span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>( </span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a>             Gimap1,</span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>             Gimap2,</span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a>             Gimap3,</span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.
Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.
Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="cold-hot-map-tourism" class="level1">
<h1>Cold hot map tourism</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>TouristAll <span class="ot">=</span> touristRAW </span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>TouristAll<span class="sc">$</span>YYYYMM <span class="ot">=</span> <span class="fu">as.integer</span>(<span class="fu">format</span>(TouristAll<span class="sc">$</span>date, <span class="st">"%Y%m"</span>))</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>TouristAll <span class="ot">=</span> TouristAll <span class="sc">%&gt;%</span>   </span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>tourist_st <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> TouristAll, </span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.geometry =</span> admRAW, </span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.loc_col =</span> <span class="st">"province_eng"</span>, </span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">.time_col =</span> <span class="st">"YYYYMM"</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(tourist_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">=</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tourist_st,</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"value"</span>,</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>,</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in spdep::poly2nb(geometry, queen = queen, ...): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in spdep::poly2nb(geometry, queen = queen, ...): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ehsa,</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classification))<span class="sc">+</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>tourist_ehsa <span class="ot">=</span> admRAW <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(province_eng <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">=</span> tourist_ehsa <span class="sc">%&gt;%</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tourist_ehsa)<span class="sc">+</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>)<span class="sc">+</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.52, 0.58, 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="revenue-analysis" class="level1">
<h1>Revenue analysis</h1>
<p>This variable shows all revenue from tourism</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset for a specific variable</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>revallRAW <span class="ot">&lt;-</span> TourismRAW <span class="sc">%&gt;%</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"revenue_all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creating-time-periods-1" class="level2">
<h2 class="anchored" data-anchor-id="creating-time-periods-1">Creating time periods</h2>
<p>we create pre covid(Pre), during covid(Cov) and post covid(Post) time periods to see the difference between them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>precovnum <span class="ot">&lt;-</span> revallRAW <span class="sc">%&gt;%</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2019</span>)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>covnum <span class="ot">&lt;-</span> revallRAW <span class="sc">%&gt;%</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2021</span>)</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>postcovnum <span class="ot">&lt;-</span> revallRAW <span class="sc">%&gt;%</span></span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">2022</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2023</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate values for each period per province</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>precovnum <span class="ot">&lt;-</span> precovnum <span class="sc">%&gt;%</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value))</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>covnum <span class="ot">&lt;-</span> covnum <span class="sc">%&gt;%</span></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value))</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a>postcovnum <span class="ot">&lt;-</span> postcovnum <span class="sc">%&gt;%</span></span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>Pre <span class="ot">&lt;-</span> <span class="fu">left_join</span>(admRAW,precovnum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_eng)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>Pre <span class="ot">&lt;-</span> Pre[<span class="sc">!</span><span class="fu">is.na</span>(Pre<span class="sc">$</span>value), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>Cov <span class="ot">&lt;-</span> <span class="fu">left_join</span>(admRAW,covnum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_eng)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>Cov <span class="ot">&lt;-</span> Cov[<span class="sc">!</span><span class="fu">is.na</span>(Cov<span class="sc">$</span>value), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb258-17"><a href="#cb258-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb258-18"><a href="#cb258-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>Post <span class="ot">&lt;-</span> <span class="fu">left_join</span>(admRAW,postcovnum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_eng)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>Post <span class="ot">&lt;-</span> Post[<span class="sc">!</span><span class="fu">is.na</span>(Post<span class="sc">$</span>value), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="global-measures-of-spatial-autocorrelation-for-tourism-numbers-1" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-for-tourism-numbers-1"><strong>Global Measures of Spatial Autocorrelation for tourism numbers</strong></h2>
<section id="computing-contiguity-spatial-weights-2" class="level3">
<h3 class="anchored" data-anchor-id="computing-contiguity-spatial-weights-2"><strong>Computing Contiguity Spatial Weights</strong></h3>
<p>Before we can compute the global spatial autocorrelation statistics, we need to construct a spatial weights of the study area. The spatial weights is used to define the neighbourhood relationships between the geographical units (i.e.&nbsp;county) in the study area.</p>
<p>In the code chunk below, <a href="https://r-spatial.github.io/spdep/reference/poly2nb.html"><code>poly2nb()</code></a> of <strong>spdep</strong> package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries. If you look at the documentation you will see that you can pass a “queen” argument that takes TRUE or FALSE as options. If you do not specify this argument the default is set to TRUE, that is, if you don’t specify queen = FALSE this function will return a list of first order neighbours using the Queen criteria.</p>
<p>More specifically, the code chunk below is used to compute Queen contiguity weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>wm_q1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Pre, </span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>wm_q2 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Cov, </span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>wm_q3 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Post, </span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_q3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</section>
<section id="row-standardised-weights-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="row-standardised-weights-matrix-1"><strong>Row-standardised weights matrix</strong></h3>
<p>Next, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values. While this is the most intuitive way to summaries the neighbors’ values it has one drawback in that polygons along the edges of the study area will base their lagged values on fewer polygons thus potentially over- or under-estimating the true nature of the spatial autocorrelation in the data. For this example, we’ll stick with the style=“W” option for simplicity’s sake but note that other more robust options are available, notably style=“B”.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>rswm_q1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q1, </span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>rswm_q1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>rswm_q2 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q2, </span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>rswm_q2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>rswm_q3 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_q3, </span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>rswm_q3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="global-measures-of-spatial-autocorrelation-morans-i-1" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-morans-i-1"><strong>Global Measures of Spatial Autocorrelation: Moran’s I</strong></h2>
<section id="marons-i-test-1" class="level3">
<h3 class="anchored" data-anchor-id="marons-i-test-1"><strong>Maron’s I test</strong></h3>
<p>The code chunk below performs Moran’s I statistical testing using <a href="https://r-spatial.github.io/spdep/reference/moran.test.html"><code>moran.test()</code></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">COV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Pre<span class="sc">$</span>value, </span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q1, </span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Pre$value  
weights: rswm_q1  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = -0.36696, p-value = 0.6432
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.032056089      -0.014925373       0.002179318 </code></pre>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Cov<span class="sc">$</span>value, </span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q2, </span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Cov$value  
weights: rswm_q2  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = -0.57476, p-value = 0.7173
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.044234715      -0.014925373       0.002600382 </code></pre>
</div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(Post<span class="sc">$</span>value, </span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>rswm_q3, </span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  Post$value  
weights: rswm_q3  
n reduced by no-neighbour observations  

Moran I statistic standard deviate = -0.25871, p-value = 0.6021
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.029416801      -0.014925373       0.003137553 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-monte-carlo-morans-i-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-monte-carlo-morans-i-1"><strong>Computing Monte Carlo Moran’s I</strong></h3>
<p>The code chunk below performs permutation test for Moran’s I statistic by using <a href="https://r-spatial.github.io/spdep/reference/moran.mc.html"><code>moran.mc()</code></a> of <strong>spdep</strong>. A total of 1000 simulation will be performed.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>bperm1<span class="ot">=</span> <span class="fu">moran.mc</span>(Pre<span class="sc">$</span>value, </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q1, </span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>bperm1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Pre$value 
weights: rswm_q1  
number of simulations + 1: 1000 

statistic = -0.032056, observed rank = 401, p-value = 0.599
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>bperm2<span class="ot">=</span> <span class="fu">moran.mc</span>(Cov<span class="sc">$</span>value, </span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q2, </span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>bperm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Cov$value 
weights: rswm_q2  
number of simulations + 1: 1000 

statistic = -0.044235, observed rank = 246, p-value = 0.754
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-27-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a>bperm3<span class="ot">=</span> <span class="fu">moran.mc</span>(Post<span class="sc">$</span>value, </span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>rswm_q3, </span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a>bperm3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  Post$value 
weights: rswm_q3  
number of simulations + 1: 1000 

statistic = -0.029417, observed rank = 496, p-value = 0.504
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualising-monte-carlo-morans-i-1" class="level3">
<h3 class="anchored" data-anchor-id="visualising-monte-carlo-morans-i-1"><strong>Visualising Monte Carlo Moran’s I</strong></h3>
<p>It is always a good practice for us the examine the simulated Moran’s I test statistics in greater detail. This can be achieved by plotting the distribution of the statistical values as a histogram by using the code chunk below.</p>
<p>In the code chunk below <a href="https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/hist"><code>hist()</code></a> and <a href="https://www.rdocumentation.org/packages/graphics/versions/3.6.2/topics/abline"><code>abline()</code></a> of R Graphics are used.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">COV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-3" role="tab" aria-controls="tabset-28-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm1<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01272293</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm1<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002824978</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm1<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.080749 -0.037950 -0.027270 -0.012723 -0.007812  0.409510 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm1<span class="sc">$</span>res, </span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-154-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm2<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01487191</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm2<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002436059</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm2<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.094256 -0.043990 -0.026517 -0.014872 -0.002192  0.337889 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm2<span class="sc">$</span>res, </span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-28-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm3<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01254189</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm3<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003632653</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm3<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.080682 -0.042963 -0.029317 -0.012542 -0.006836  0.483887 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm3<span class="sc">$</span>res, </span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-162-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="global-measures-of-spatial-autocorrelation-gearys-c-1" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-gearys-c-1"><strong>Global Measures of Spatial Autocorrelation: Geary’s C</strong></h2>
<section id="gearys-c-test-1" class="level3">
<h3 class="anchored" data-anchor-id="gearys-c-test-1"><strong>Geary’s C test</strong></h3>
<p>The code chunk below performs Geary’s C test for spatial autocorrelation by using <a href="https://r-spatial.github.io/spdep/reference/geary.test.html"><code>geary.test()</code></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-3" role="tab" aria-controls="tabset-29-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Pre<span class="sc">$</span>value, <span class="at">listw=</span>rswm_q1, <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Pre$value 
weights: rswm_q1  
n reduced by no-neighbour observations 

Geary C statistic standard deviate = -0.46128, p-value = 0.6777
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       1.08355636        1.00000000        0.03281132 </code></pre>
</div>
</div>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Cov<span class="sc">$</span>value, <span class="at">listw=</span>rswm_q2, <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Cov$value 
weights: rswm_q2  
n reduced by no-neighbour observations 

Geary C statistic standard deviate = -0.59658, p-value = 0.7246
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       1.10473434        1.00000000        0.03082015 </code></pre>
</div>
</div>
</div>
<div id="tabset-29-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(Post<span class="sc">$</span>value, <span class="at">listw=</span>rswm_q3, <span class="at">na.action=</span>na.omit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  Post$value 
weights: rswm_q3  
n reduced by no-neighbour observations 

Geary C statistic standard deviate = 0.14061, p-value = 0.4441
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       0.97635373        1.00000000        0.02827992 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-monte-carlo-gearys-c-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-monte-carlo-gearys-c-1"><strong>Computing Monte Carlo Geary’s C</strong></h3>
<p>The code chunk below performs permutation test for Geary’s C statistic by using <a href="https://r-spatial.github.io/spdep/reference/geary.mc.html"><code>geary.mc()</code></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>bperm11<span class="ot">=</span><span class="fu">geary.mc</span>(Pre<span class="sc">$</span>value, </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>rswm_q1, </span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>,</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action=</span>na.omit)</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>bperm11</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Pre$value 
weights: rswm_q1  
number of simulations + 1: 1000 

statistic = 1.0836, observed rank = 683, p-value = 0.683
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>bperm22<span class="ot">=</span><span class="fu">geary.mc</span>(Cov<span class="sc">$</span>value, </span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>rswm_q2, </span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>,</span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action=</span>na.omit)</span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true" tabindex="-1"></a>bperm22</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Cov$value 
weights: rswm_q2  
number of simulations + 1: 1000 

statistic = 1.1047, observed rank = 728, p-value = 0.728
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>bperm33<span class="ot">=</span><span class="fu">geary.mc</span>(Post<span class="sc">$</span>value, </span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>rswm_q3, </span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>,</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.action=</span>na.omit)</span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>bperm33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  Post$value 
weights: rswm_q3  
number of simulations + 1: 1000 

statistic = 0.97635, observed rank = 495, p-value = 0.495
alternative hypothesis: greater</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualising-the-monte-carlo-gearys-c-1" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-monte-carlo-gearys-c-1"><strong>Visualising the Monte Carlo Geary’s C</strong></h3>
<p>Next, we will plot a histogram to reveal the distribution of the simulated values by using the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-3" role="tab" aria-controls="tabset-31-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm11<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9804112</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm11<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04603458</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm11<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1261  0.8609  0.9783  0.9804  1.1223  1.6964 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm11<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm22<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9807089</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm22<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04296244</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm22<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1416  0.8647  0.9794  0.9807  1.1191  1.6793 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm22<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-176-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-31-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm33<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9808983</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm33<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0394471</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm33<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1831  0.8721  0.9780  0.9809  1.1097  1.6516 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm33<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="spatial-correlogram-1" class="level2">
<h2 class="anchored" data-anchor-id="spatial-correlogram-1"><strong>Spatial Correlogram</strong></h2>
<p>Spatial correlograms are great to examine patterns of spatial autocorrelation in your data or model residuals. They show how correlated are pairs of spatial observations when you increase the distance (lag) between them - they are plots of some index of autocorrelation (Moran’s I or Geary’s c) against distance.Although correlograms are not as fundamental as variograms (a keystone concept of geostatistics), they are very useful as an exploratory and descriptive tool. For this purpose they actually provide richer information than variograms.</p>
</section>
</section>
<section id="local-measures-of-spatial-autocorrelation-for-total-revenue" class="level1">
<h1><strong>Local Measures of Spatial Autocorrelation for total Revenue</strong></h1>
<section id="overview-1" class="level2">
<h2 class="anchored" data-anchor-id="overview-1"><strong>Overview</strong></h2>
<p>Local Measures of Spatial Autocorrelation (LMSA) focus on the relationships between each observation and its surroundings, rather than providing a single summary of these relationships across the map. In this sense, they are not summary statistics but scores that allow us to learn more about the spatial structure in our data. The general intuition behind the metrics however is similar to that of global ones. Some of them are even mathematically connected, where the global version can be decomposed into a collection of local ones. One such example are Local Indicators of Spatial Association (LISA). Beside LISA, Getis-Ord’s Gi-statistics will be introduce as an alternative LMSA statistics that present complementary information or allow us to obtain similar insights for geographically referenced data.</p>
<section id="visualising-regional-development-indicator-1" class="level3">
<h3 class="anchored" data-anchor-id="visualising-regional-development-indicator-1"><strong>Visualising Regional Development Indicator</strong></h3>
<p>Now, we are going to prepare a basemap and a choropleth map showing the distribution of Tourism data by using <em>qtm()</em> of <strong>tmap</strong> package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-3" role="tab" aria-controls="tabset-32-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre) <span class="sc">+</span></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-181-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov) <span class="sc">+</span></span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb351-17"><a href="#cb351-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb351-18"><a href="#cb351-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-182-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-32-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"equal"</span>) <span class="sc">+</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal interval classification"</span>)</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a>quantile <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post) <span class="sc">+</span></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"value"</span>,</span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>) <span class="sc">+</span></span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb352-13"><a href="#cb352-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Equal quantile classification"</span>)</span>
<span id="cb352-14"><a href="#cb352-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-15"><a href="#cb352-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(equal, </span>
<span id="cb352-16"><a href="#cb352-16" aria-hidden="true" tabindex="-1"></a>             quantile, </span>
<span id="cb352-17"><a href="#cb352-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb352-18"><a href="#cb352-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-183-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="local-indicators-of-spatial-associationlisa-1" class="level2">
<h2 class="anchored" data-anchor-id="local-indicators-of-spatial-associationlisa-1"><strong>Local Indicators of Spatial Association(LISA)</strong></h2>
<p>Local Indicators of Spatial Association or LISA are statistics that evaluate the existence of clusters and/or outliers in the spatial arrangement of a given variable.</p>
<section id="computing-contiguity-spatial-weights-3" class="level3">
<h3 class="anchored" data-anchor-id="computing-contiguity-spatial-weights-3"><strong>Computing Contiguity Spatial Weights</strong></h3>
<p>Before we can compute the local spatial autocorrelation statistics, we need to construct a spatial weights of the study area. The spatial weights is used to define the neighbourhood relationships between the geographical units (i.e.&nbsp;county) in the study area.</p>
<p>In the code chunk below, <a href="https://r-spatial.github.io/spdep/reference/poly2nb.html"><code>poly2nb()</code></a> of <strong>spdep</strong> package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries. If you look at the documentation you will see that you can pass a “queen” argument that takes TRUE or FALSE as options. If you do not specify this argument the default is set to TRUE, that is, if you don’t specify queen = FALSE this function will return a list of first order neighbours using the Queen criteria.</p>
<p>More specifically, the code chunk below is used to compute Queen contiguity weight matrix.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-3" role="tab" aria-controls="tabset-33-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>localwm_q1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Pre, </span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Pre, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localwm_q1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</div>
<div id="tabset-33-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>localwm_q2 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Cov, </span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Cov, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localwm_q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</div>
<div id="tabset-33-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>localwm_q3 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(Post, </span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">queen=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in poly2nb(Post, queen = TRUE): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localwm_q3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  5  6  7  9 
 1  2  7 17 15 11 12  3  1 
2 least connected regions:
12 14 with 1 link
1 most connected region:
51 with 9 links</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="row-standardised-weights-matrix-2" class="level3">
<h3 class="anchored" data-anchor-id="row-standardised-weights-matrix-2"><strong>Row-standardised weights matrix</strong></h3>
<p>Next, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values. While this is the most intuitive way to summaries the neighbors’ values it has one drawback in that polygons along the edges of the study area will base their lagged values on fewer polygons thus potentially over- or under-estimating the true nature of the spatial autocorrelation in the data. For this example, we’ll stick with the style=“W” option for simplicity’s sake but note that other more robust options are available, notably style=“B”.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-3" role="tab" aria-controls="tabset-34-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>rswm_qlocal1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(localwm_q1, </span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>rswm_qlocal1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>rswm_qlocal2 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(localwm_q2, </span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>rswm_qlocal2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
<div id="tabset-34-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>rswm_qlocal3 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(localwm_q3, </span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">style=</span><span class="st">"W"</span>, </span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>rswm_qlocal3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 284 
Percentage nonzero weights: 5.965133 
Average number of links: 4.115942 
1 region with no links:
67
2 disjoint connected subgraphs

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 68 4624 68 36.26116 284.0635</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-local-morans-i-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-local-morans-i-1"><strong>Computing local Moran’s I</strong></h3>
<p>To compute local Moran’s I, the <a href="https://r-spatial.github.io/spdep/reference/localmoran.html"><em>localmoran()</em></a> function of <strong>spdep</strong> will be used. It computes <em>Ii</em> values, given a set of <em>zi</em> values and a listw object providing neighbour weighting information for the polygon associated with the zi values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>fips1 <span class="ot">&lt;-</span> <span class="fu">order</span>(Pre<span class="sc">$</span>value)</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>localMI1 <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Pre<span class="sc">$</span>value, rswm_qlocal1)</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii          E.Ii      Var.Ii       Z.Ii Pr(z != E(Ii))
1 -1.62587607 -0.8325197754 1.483791299 -0.6513012   5.148521e-01
2 -0.73148625 -0.0005890336 0.020006558 -5.1673766   2.374026e-07
3 -0.37916430 -0.0006942310 0.011431328 -3.5398365   4.003750e-04
4 -0.24789541 -0.0007505177 0.007980859 -2.7664756   5.666583e-03
5  0.02428098 -0.0001835184 0.001952606  0.5536419   5.798239e-01
6  0.04600063 -0.0008740871 0.019486835  0.3357902   7.370291e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>fips2 <span class="ot">&lt;-</span> <span class="fu">order</span>(Cov<span class="sc">$</span>value)</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>localMI2 <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Cov<span class="sc">$</span>value, rswm_qlocal2)</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii          E.Ii      Var.Ii       Z.Ii Pr(z != E(Ii))
1 -1.96086714 -0.8007467620 1.697912502 -0.8903185   3.732949e-01
2 -0.92877251 -0.0009924257 0.033694188 -5.0543760   4.318001e-07
3 -0.44867282 -0.0010370044 0.017069636 -3.4261998   6.120899e-04
4 -0.30696382 -0.0012320219 0.013094767 -2.6717248   7.546250e-03
5  0.02298447 -0.0001133665 0.001206286  0.6650375   5.060265e-01
6  0.06504788 -0.0014217994 0.031680119  0.3734480   7.088150e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>fips3 <span class="ot">&lt;-</span> <span class="fu">order</span>(Post<span class="sc">$</span>value)</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>localMI3 <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(Post<span class="sc">$</span>value, rswm_qlocal3)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Ii          E.Ii       Var.Ii       Z.Ii Pr(z != E(Ii))
1 -1.62688650 -7.351427e-01 2.0720406541 -0.6194995   5.355874e-01
2 -0.76461738 -7.268483e-04 0.0246840386 -4.8620903   1.161526e-06
3 -0.37000978 -7.509636e-04 0.0123647935 -3.3207596   8.977281e-04
4 -0.25618657 -9.032642e-04 0.0096036661 -2.6049769   9.188044e-03
5  0.01210192 -4.357086e-05 0.0004636517  0.5640520   5.727188e-01
6  0.04820920 -1.119993e-03 0.0249628970  0.3122170   7.548756e-01</code></pre>
</div>
</div>
<p><em>localmoran()</em> function returns a matrix of values whose columns are:</p>
<ul>
<li><p>Ii: the local Moran’s I statistics</p></li>
<li><p>E.Ii: the expectation of local moran statistic under the randomisation hypothesis</p></li>
<li><p>Var.Ii: the variance of local moran statistic under the randomisation hypothesis</p></li>
<li><p>Z.Ii:the standard deviate of local moran statistic</p></li>
<li><p>Pr(): the p-value of local moran statistic</p></li>
</ul>
<p>The code chunk below list the content of the local Moran matrix derived by using <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/printCoefmat"><em>printCoefmat()</em></a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-3" role="tab" aria-controls="tabset-35-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>  localMI1[fips1,], </span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Pre<span class="sc">$</span>value[fips1]),</span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..
439290000      5.4816e-02 -9.0433e-04  2.0160e-02  3.9243e-01         0.6947
832460000      5.5557e-02 -8.8357e-04  1.4546e-02  4.6797e-01         0.6398
877620000      5.5121e-02 -8.8120e-04  1.9645e-02  3.9956e-01         0.6895
1013520000     4.6001e-02 -8.7409e-04  1.9487e-02  3.3579e-01         0.7370
1046100000     1.8096e-02 -8.7239e-04  1.9449e-02  1.3601e-01         0.8918
1070360000     5.5028e-02 -8.7112e-04  1.9421e-02  4.0112e-01         0.6883
1197630000     5.0320e-02 -8.6450e-04  1.4233e-02  4.2904e-01         0.6679
1241890000     4.9581e-02 -8.6220e-04  9.1675e-03  5.2684e-01         0.5983
1354470000     4.0900e-02 -8.5638e-04  1.4099e-02  3.5167e-01         0.7251
1403160000     4.3800e-02 -8.5386e-04  1.4058e-02  3.7662e-01         0.7065
1451390000     5.6924e-02 -8.5137e-04  1.1038e-02  5.4991e-01         0.5824
1499070000     5.0781e-02 -8.4892e-04  1.3976e-02  4.3672e-01         0.6623
1660010000     5.1275e-02 -8.4066e-04  1.0899e-02  4.9919e-01         0.6176
1682620000    -1.0919e-02 -8.3950e-04  1.8716e-02 -7.3674e-02         0.9413
1760690000     5.4800e-02 -8.3551e-04  1.0833e-02  5.3455e-01         0.5930
2182030000     5.5028e-02 -8.1414e-04  1.8151e-02  4.1448e-01         0.6785
2203120000     3.0220e-02 -8.1308e-04  1.8128e-02  2.3049e-01         0.8177
2240800000     5.1756e-02 -8.1118e-04  1.3356e-02  4.5487e-01         0.6492
2476930000     5.1437e-02 -7.9935e-04  8.4997e-03  5.6659e-01         0.5710
2488740000    -4.0029e-01 -7.9876e-04  1.3151e-02 -3.4836e+00         0.0005
2723910000     5.5074e-02 -7.8707e-04  1.7548e-02  4.2169e-01         0.6733
3081410000     3.6397e-02 -7.6945e-04  1.7156e-02  2.8375e-01         0.7766
3167900000     5.5097e-02 -7.6522e-04  2.5986e-02  3.4653e-01         0.7289
3170560000     5.3649e-02 -7.6509e-04  2.5982e-02  3.3758e-01         0.7357
3340550000     1.8118e-02 -7.5681e-04  1.6874e-02  1.4530e-01         0.8845
3423810000     1.5165e-02 -7.5277e-04  1.2395e-02  1.4298e-01         0.8863
3470340000    -2.4790e-01 -7.5052e-04  7.9809e-03 -2.7665e+00         0.0057
3583740000     5.4181e-02 -7.4504e-04  7.9227e-03  6.1708e-01         0.5372
3886930000     4.8987e-02 -7.3050e-04  7.7681e-03  5.6409e-01         0.5727
3981200000     5.0318e-02 -7.2601e-04  7.7204e-03  5.8093e-01         0.5613
4351570000     1.9517e-02 -7.0849e-04  6.3538e-03  2.5374e-01         0.7997
4406940000     3.2476e-02 -7.0589e-04  9.1532e-03  3.4683e-01         0.7287
4464180000    -2.6138e-02 -7.0321e-04  2.3882e-02 -1.6459e-01         0.8693
4656420000    -3.7916e-01 -6.9423e-04  1.1431e-02 -3.5398e+00         0.0004
4660380000     3.8291e-02 -6.9405e-04  8.9998e-03  4.1094e-01         0.6811
5085780000    -2.3245e-01 -6.7440e-04  7.1719e-03 -2.7369e+00         0.0062
5303860000    -3.7898e-02 -6.6443e-04  2.2566e-02 -2.4786e-01         0.8042
5675580000     4.5210e-02 -6.4762e-04  1.0664e-02  4.4407e-01         0.6570
5717250000     3.8270e-02 -6.4575e-04  6.8675e-03  4.6960e-01         0.6386
6201880000    -1.9087e-01 -6.2418e-04  5.5982e-03 -2.5427e+00         0.0110
6761140000     3.1833e-02 -5.9975e-04  1.3374e-02  2.8044e-01         0.7791
6810880000     3.0441e-02 -5.9760e-04  9.8411e-03  3.1288e-01         0.7544
7010030000    -7.3149e-01 -5.8903e-04  2.0007e-02 -5.1674e+00         0.0000
7293470000     2.3987e-02 -5.7695e-04  3.8929e-03  3.9370e-01         0.6938
7535610000    -1.7942e-02 -5.6672e-04  1.2638e-02 -1.5456e-01         0.8772
7658970000     3.4815e-02 -5.6155e-04  9.2478e-03  3.6787e-01         0.7130
7680850000     3.9799e-02 -5.6063e-04  5.9628e-03  5.2267e-01         0.6012
7997570000     4.7570e-02 -5.4747e-04  1.8596e-02  3.5286e-01         0.7242
8555020000     4.2486e-02 -5.2467e-04  5.5805e-03  5.7576e-01         0.5648
8713840000     2.3696e-02 -5.1827e-04  8.5354e-03  2.6210e-01         0.7932
9239110000     1.0774e-02 -4.9737e-04  1.1092e-02  1.0702e-01         0.9148
9561350000    -9.0277e-04 -4.8476e-04  7.9838e-03 -4.6783e-03         0.9963
11425460000    3.4325e-02 -4.1498e-04  5.3827e-03  4.7352e-01         0.6358
1.5996e+10    -2.2209e-02 -2.6684e-04  3.4617e-03 -3.7294e-01         0.7092
18111280000    2.3370e-02 -2.0931e-04  1.8780e-03  5.4410e-01         0.5864
19153920000    2.4281e-02 -1.8352e-04  1.9526e-03  5.5364e-01         0.5798
19713730000    2.0206e-02 -1.7037e-04  1.1754e-02  1.8795e-01         0.8509
24744100000    1.3539e-02 -7.4145e-05  9.6204e-04  4.3890e-01         0.6607
27883920000    1.0342e-02 -3.4085e-05  4.4228e-04  4.9337e-01         0.6218
29291710000   -1.1899e-03 -2.1116e-05  4.7115e-04 -5.3847e-02         0.9571
31034390000    3.2792e-03 -9.3415e-06  2.0844e-04  2.2778e-01         0.8198
37081190000   -3.5342e-03 -5.2120e-06  3.5963e-04 -1.8609e-01         0.8524
42392630000   -6.3686e-03 -4.8623e-05  1.6524e-03 -1.5547e-01         0.8764
66365520000   -4.7121e-02 -7.9193e-04  1.0268e-02 -4.5720e-01         0.6475
94287120000    1.6392e-03 -2.7874e-03  4.5802e-02  2.0684e-02         0.9835
110670330000  -1.0061e-01 -4.5243e-03  5.8442e-02 -3.9746e-01         0.6910
112055500000   2.2421e-02 -4.6903e-03  1.0417e-01  8.4003e-02         0.9331
442890670000   0.0000e+00  0.0000e+00  0.0000e+00         NaN            NaN
1067813760000 -1.6259e+00 -8.3252e-01  1.4838e+00 -6.5130e-01         0.5149</code></pre>
</div>
</div>
</div>
<div id="tabset-35-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>  localMI2[fips2,], </span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Cov<span class="sc">$</span>value[fips2]),</span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..
347230000     8.5213e-02 -1.5009e-03  3.3440e-02  4.7419e-01         0.6354
506420000     8.7039e-02 -1.4648e-03  2.4101e-02  5.7009e-01         0.5686
625060000     2.9139e-02 -1.4382e-03  3.2045e-02  1.7081e-01         0.8644
640910000     8.2014e-02 -1.4347e-03  3.1966e-02  4.6674e-01         0.6407
698660000     6.5048e-02 -1.4218e-03  3.1680e-02  3.7345e-01         0.7088
791930000     6.8955e-02 -1.4012e-03  1.4890e-02  5.7658e-01         0.5642
808940000     8.3182e-02 -1.3974e-03  3.1138e-02  4.7932e-01         0.6317
835010000    -5.0953e-01 -1.3917e-03  2.2900e-02 -3.3579e+00         0.0008
844860000     7.1068e-02 -1.3895e-03  2.2864e-02  4.7918e-01         0.6318
970340000     9.0434e-02 -1.3621e-03  4.6229e-02  4.2694e-01         0.6694
1187210000    8.8783e-02 -1.3154e-03  1.7046e-02  6.9009e-01         0.4901
1202240000    3.2661e-02 -1.3122e-03  2.1593e-02  2.3119e-01         0.8172
1258250000    6.5348e-02 -1.3003e-03  2.1397e-02  4.5562e-01         0.6487
1285790000    7.0181e-02 -1.2944e-03  1.6775e-02  5.5186e-01         0.5810
1378990000    4.1117e-02 -1.2748e-03  2.0978e-02  2.9268e-01         0.7698
1440050000   -9.8233e-02 -1.2620e-03  2.8123e-02 -5.7824e-01         0.5631
1532830000    8.8151e-03 -1.2426e-03  2.7693e-02  6.0439e-02         0.9518
1583988000   -3.0696e-01 -1.2320e-03  1.3095e-02 -2.6717e+00         0.0075
1630210000    7.0716e-02 -1.2225e-03  2.0119e-02  5.0717e-01         0.6120
1659710000    7.7544e-02 -1.2164e-03  1.5765e-02  6.2727e-01         0.5305
1723580000    8.2330e-02 -1.2033e-03  2.6818e-02  5.1008e-01         0.6100
1806160000   -1.2466e-02 -1.1865e-03  4.0276e-02 -5.6204e-02         0.9552
1831670000    8.3255e-03 -1.1814e-03  1.9443e-02  6.8180e-02         0.9456
1908320000    2.9161e-02 -1.1659e-03  2.5985e-02  1.8813e-01         0.8508
2006890000    7.2660e-02 -1.1462e-03  1.2183e-02  6.6866e-01         0.5037
2111990000    8.3881e-02 -1.1253e-03  3.8201e-02  4.3493e-01         0.6636
2137810000    8.3170e-02 -1.1202e-03  1.1908e-02  7.7243e-01         0.4399
2536360000    6.5511e-02 -1.0430e-03  1.1088e-02  6.3204e-01         0.5274
2568164700   -4.4867e-01 -1.0370e-03  1.7070e-02 -3.4262e+00         0.0006
2571390000    7.7017e-02 -1.0364e-03  2.3102e-02  5.1354e-01         0.6076
2659740000    2.7624e-02 -1.0197e-03  2.2730e-02  1.8999e-01         0.8493
2805840000   -9.2877e-01 -9.9243e-04  3.3694e-02 -5.0544e+00         0.0000
3235700000    6.5848e-02 -9.1429e-04  9.7208e-03  6.7714e-01         0.4983
3327450000    1.6153e-02 -8.9802e-04  1.1642e-02  1.5802e-01         0.8744
3443380000    5.9195e-02 -8.7768e-04  1.4449e-02  4.9975e-01         0.6173
3476880000    3.6818e-02 -8.7185e-04  1.1303e-02  3.5450e-01         0.7230
3479791500   -2.2572e-01 -8.7134e-04  7.8130e-03 -2.5438e+00         0.0110
3651050000   -3.2561e-02 -8.4183e-04  1.8768e-02 -2.3153e-01         0.8169
3856120000   -1.4520e-01 -8.0716e-04  2.7409e-02 -8.7218e-01         0.3831
3860690000    2.1772e-02 -8.0640e-04  1.7979e-02  1.6839e-01         0.8663
3872512000    2.6692e-02 -8.0442e-04  1.3244e-02  2.3893e-01         0.8112
3885630000   -1.0888e-02 -8.0223e-04  7.1938e-03 -1.1891e-01         0.9053
4090640000   -2.3714e-01 -7.6840e-04  8.1709e-03 -2.6149e+00         0.0089
4137150000    3.8125e-02 -7.6083e-04  8.0904e-03  4.3232e-01         0.6655
4914140000    6.6236e-02 -6.3986e-04  2.1732e-02  4.5365e-01         0.6501
4935630000    4.0847e-03 -6.3667e-04  4.2956e-03  7.2037e-02         0.9426
5265060000    3.1567e-02 -5.8866e-04  9.6940e-03  3.2659e-01         0.7440
5351750000    1.1519e-03 -5.7634e-04  9.4913e-03  1.7739e-02         0.9858
6447510000    3.6642e-02 -4.3185e-04  4.5937e-03  5.4700e-01         0.5844
6456340000    1.8550e-02 -4.3077e-04  7.0950e-03  2.2534e-01         0.8217
6718420000    9.6139e-03 -3.9933e-04  8.9070e-03  1.0610e-01         0.9155
6846620000    4.2130e-02 -3.8439e-04  4.0890e-03  6.6486e-01         0.5061
7809350000    3.0870e-02 -2.8128e-04  3.6489e-03  5.1570e-01         0.6061
9889390000    2.2984e-02 -1.1337e-04  1.2063e-03  6.6504e-01         0.5060
10988520000  -7.7991e-03 -5.4928e-05  7.1271e-04 -2.9008e-01         0.7718
11727340000   7.3899e-03 -2.7416e-05  1.8917e-03  1.7054e-01         0.8646
11841010000   7.7319e-03 -2.4024e-05  2.1559e-04  5.2822e-01         0.5973
16487420000  -1.2390e-02 -7.7063e-05  5.3170e-03 -1.6885e-01         0.8659
18481640000  -2.4143e-02 -2.1462e-04  2.7844e-03 -4.5347e-01         0.6502
22897720000   6.9901e-02 -7.6462e-04  1.7048e-02  5.4121e-01         0.5884
23392430000  -1.1614e-02 -8.4729e-04  1.8890e-02 -7.8335e-02         0.9376
23700530000  -6.0629e-02 -9.0093e-04  1.1680e-02 -5.5266e-01         0.5805
26124870000  -6.7624e-02 -1.3804e-03  1.7887e-02 -4.9531e-01         0.6204
26975780000  -8.0421e-03 -1.5728e-03  2.5875e-02 -4.0217e-02         0.9679
28551560000   1.4160e-04 -1.9623e-03  6.6558e-02  8.1550e-03         0.9935
33525870000   1.1009e-02 -3.4743e-03  7.7254e-02  5.2108e-02         0.9584
73132280000  -2.1449e-01 -3.0819e-02  3.8758e-01 -2.9503e-01         0.7680
129783630000  0.0000e+00  0.0000e+00  0.0000e+00         NaN            NaN
317440070000 -1.9609e+00 -8.0075e-01  1.6979e+00 -8.9032e-01         0.3733</code></pre>
</div>
</div>
</div>
<div id="tabset-35-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>  localMI3[fips3,], </span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>Post<span class="sc">$</span>value[fips3]),</span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..
288580000     7.1769e-02 -1.1931e-03  2.6590e-02  4.4745e-01         0.6546
497800000     7.2666e-02 -1.1653e-03  1.9179e-02  5.3312e-01         0.5939
667970000     4.5883e-02 -1.1429e-03  2.5474e-02  2.9464e-01         0.7683
706040000     6.3921e-02 -1.1380e-03  1.8730e-02  4.7538e-01         0.6345
791220000     6.1174e-02 -1.1269e-03  1.1979e-02  5.6923e-01         0.5692
844470000     4.8209e-02 -1.1200e-03  2.4963e-02  3.1222e-01         0.7549
901600000     6.2193e-02 -1.1126e-03  2.4799e-02  4.0200e-01         0.6877
913660000     3.7719e-02 -1.1111e-03  1.8287e-02  2.8714e-01         0.7740
959320000    -4.3859e-01 -1.1052e-03  1.8191e-02 -3.2437e+00         0.0012
1011090000    7.3328e-02 -1.0985e-03  1.4239e-02  6.2372e-01         0.5328
1040740000    7.1900e-02 -1.0947e-03  3.7164e-02  3.7864e-01         0.7050
1111400000    6.5056e-02 -1.0857e-03  2.4200e-02  4.2518e-01         0.6707
1307920000    5.3466e-02 -1.0608e-03  1.7461e-02  4.1264e-01         0.6799
1426390000   -4.4348e-03 -1.0460e-03  3.5510e-02 -1.7983e-02         0.9857
1542030000    3.0712e-02 -1.0316e-03  1.6980e-02  2.4361e-01         0.8075
1545290000    5.8686e-02 -1.0312e-03  1.6973e-02  4.5837e-01         0.6467
1597980000    5.7208e-02 -1.0246e-03  1.3282e-02  5.0528e-01         0.6134
1688090000   -4.6210e-02 -1.0135e-03  2.2592e-02 -3.0069e-01         0.7636
1723260000    3.1496e-02 -1.0092e-03  2.2496e-02  2.1672e-01         0.8284
1876690000    7.1560e-02 -9.9042e-04  3.3626e-02  3.9564e-01         0.6924
2256270000    1.7436e-02 -9.4478e-04  1.5553e-02  1.4739e-01         0.8828
2367900000    1.9397e-02 -9.3156e-04  1.2077e-02  1.8498e-01         0.8532
2487410000    5.9624e-02 -9.1751e-04  9.7550e-03  6.1297e-01         0.5399
2565470000    5.5390e-02 -9.0839e-04  9.6581e-03  5.7286e-01         0.5667
2582880000    4.3386e-02 -9.0637e-04  2.0206e-02  3.1159e-01         0.7554
2609550000   -2.5619e-01 -9.0326e-04  9.6037e-03 -2.6050e+00         0.0092
2743700000    6.2812e-02 -8.8774e-04  1.9791e-02  4.5280e-01         0.6507
2759030000    6.5942e-02 -8.8598e-04  9.4201e-03  6.8855e-01         0.4911
2920220000    5.8338e-02 -8.6753e-04  1.1247e-02  5.5826e-01         0.5767
3769960000   -2.6599e-02 -7.7347e-04  1.7245e-02 -1.9666e-01         0.8441
3793300000    6.4835e-02 -7.7096e-04  2.6181e-02  4.0546e-01         0.6851
3893950000    5.7685e-02 -7.6019e-04  1.6950e-02  4.4892e-01         0.6535
3980790000   -3.7001e-01 -7.5096e-04  1.2365e-02 -3.3208e+00         0.0009
4025230000    3.7239e-02 -7.4626e-04  9.6764e-03  3.8616e-01         0.6994
4049550000    3.9639e-02 -7.4370e-04  1.2245e-02  3.6493e-01         0.7152
4179520000    5.1051e-02 -7.3006e-04  1.2021e-02  4.7228e-01         0.6367
4210270000   -7.6462e-01 -7.2685e-04  2.4684e-02 -4.8621e+00         0.0000
4235180000    3.5104e-02 -7.2425e-04  1.6149e-02  2.8194e-01         0.7780
4340990000    3.2923e-02 -7.1329e-04  1.1745e-02  3.1037e-01         0.7563
4446330000   -1.9355e-01 -7.0245e-04  6.2997e-03 -2.4297e+00         0.0151
5122830000    4.9184e-02 -6.3484e-04  6.7516e-03  6.0630e-01         0.5443
5184750000   -3.8198e-03 -6.2883e-04  5.6398e-03 -4.2491e-02         0.9661
5210970000   -7.5825e-02 -6.2629e-04  2.1271e-02 -5.1560e-01         0.6061
5575560000    2.3228e-02 -5.9151e-04  1.3191e-02  2.0739e-01         0.8357
5950560000    3.1110e-02 -5.5678e-04  5.9218e-03  4.1151e-01         0.6807
6126410000   -1.9066e-01 -5.4085e-04  5.7525e-03 -2.5066e+00         0.0122
6172350000    1.2850e-02 -5.3673e-04  3.6216e-03  2.2244e-01         0.8240
6338720000    2.9219e-02 -5.2193e-04  8.5957e-03  3.2079e-01         0.7484
6879830000    6.1926e-03 -4.7523e-04  6.1637e-03  8.4930e-02         0.9323
7100440000    2.7480e-02 -4.5682e-04  1.0189e-02  2.7678e-01         0.7820
7425020000    2.6582e-02 -4.3039e-04  7.0888e-03  3.2083e-01         0.7483
7509640000    3.6802e-02 -4.2363e-04  5.4948e-03  5.0219e-01         0.6155
7635820000    3.9915e-02 -4.1365e-04  4.4002e-03  6.0797e-01         0.5432
8319550000    3.2429e-02 -3.6164e-04  3.8471e-03  5.2867e-01         0.5970
10815140000   2.2049e-02 -2.0143e-04  1.3896e-02  1.8875e-01         0.8503
11288750000   2.2885e-02 -1.7629e-04  1.5818e-03  5.7985e-01         0.5620
12236150000   1.8676e-02 -1.3101e-04  1.6998e-03  4.5616e-01         0.6483
12532210000   1.6892e-02 -1.1824e-04  8.1573e-03  1.8834e-01         0.8506
14742630000   1.2102e-02 -4.3571e-05  4.6365e-04  5.6405e-01         0.5727
19873080000  -6.3334e-03 -1.0999e-05  1.4272e-04 -5.2922e-01         0.5966
20222600000  -1.5078e-03 -1.5937e-05  3.5560e-04 -7.9112e-02         0.9369
26284600000  -2.9037e-02 -2.4681e-04  3.2018e-03 -5.0881e-01         0.6109
29347480000  -5.9573e-03 -4.6789e-04  1.0435e-02 -5.3737e-02         0.9571
34631220000  -4.2204e-02 -1.0141e-03  1.6692e-02 -3.1881e-01         0.7499
40243070000  -8.9713e-03 -1.8226e-03  6.1829e-02 -2.8749e-02         0.9771
43368340000   6.2375e-02 -2.3749e-03  5.2867e-02  2.8161e-01         0.7782
76243090000  -8.6081e-02 -1.2607e-02  1.6153e-01 -1.8281e-01         0.8549
258106830000  0.0000e+00  0.0000e+00  0.0000e+00         NaN            NaN
461713600000 -1.6269e+00 -7.3514e-01  2.0720e+00 -6.1950e-01         0.5356</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="mapping-the-local-morans-i-1" class="level4">
<h4 class="anchored" data-anchor-id="mapping-the-local-morans-i-1">Mapping the local Moran’s I</h4>
<p>Before mapping the local Moran’s I map, it is wise to append the local Moran’s I dataframe (i.e.&nbsp;localMI) onto the SpatialPolygonDataFrame. The code chunks below can be used to perform the task.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-3" role="tab" aria-controls="tabset-36-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>Pre.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Pre,localMI1) <span class="sc">%&gt;%</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>Cov.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Cov,localMI2) <span class="sc">%&gt;%</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-36-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a>Post.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Post,localMI3) <span class="sc">%&gt;%</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping-local-morans-i-values-1" class="level4">
<h4 class="anchored" data-anchor-id="mapping-local-morans-i-values-1">Mapping local Moran’s I values</h4>
<p>Using choropleth mapping functions of <strong>tmap</strong> package, we can plot the local Moran’s I values by using the code chinks below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-3" role="tab" aria-controls="tabset-37-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-37-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Pre.localMI) <span class="sc">+</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-199-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-37-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Cov.localMI) <span class="sc">+</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-200-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-37-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Post.localMI) <span class="sc">+</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-201-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping-local-morans-i-p-values-1" class="level4">
<h4 class="anchored" data-anchor-id="mapping-local-morans-i-p-values-1">Mapping local Moran’s I p-values</h4>
<p>The choropleth shows there is evidence for both positive and negative Ii values. However, it is useful to consider the p-values for each of these values, as consider above.</p>
<p>The code chunks below produce a choropleth map of Moran’s I p-values by using functions of <strong>tmap</strong> package.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-2" role="tab" aria-controls="tabset-38-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-3" role="tab" aria-controls="tabset-38-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-38-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Pre.localMI) <span class="sc">+</span></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-202-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-38-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Cov.localMI) <span class="sc">+</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-203-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-38-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Post.localMI) <span class="sc">+</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-204-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="creating-a-lisa-cluster-map-1" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-lisa-cluster-map-1"><strong>Creating a LISA Cluster Map</strong></h2>
<p>The LISA Cluster Map shows the significant locations color coded by type of spatial autocorrelation. The first step before we can generate the LISA cluster map is to plot the Moran scatterplot.</p>
<section id="plotting-moran-scatterplot-1" class="level3">
<h3 class="anchored" data-anchor-id="plotting-moran-scatterplot-1"><strong>Plotting Moran scatterplot</strong></h3>
<p>The Moran scatterplot is an illustration of the relationship between the values of the chosen attribute at each location and the average value of the same attribute at neighboring locations.</p>
<p>The code chunk below plots the Moran scatterplot by using <a href="https://r-spatial.github.io/spdep/reference/moran.plot.html"><em>moran.plot()</em></a> of <strong>spdep</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-3" role="tab" aria-controls="tabset-39-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-39-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>ncipre <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Pre<span class="sc">$</span>value, rswm_qlocal1,</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Pre<span class="sc">$</span>province_eng), </span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Tourists"</span>, </span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Spatially Lag tourists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-205-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-39-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>ncicov <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Cov<span class="sc">$</span>value, rswm_qlocal2,</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Cov<span class="sc">$</span>province_eng), </span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Tourists"</span>, </span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Spatially Lag tourists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-206-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-39-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>ncipost <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(Post<span class="sc">$</span>value, rswm_qlocal3,</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels=</span><span class="fu">as.character</span>(Post<span class="sc">$</span>province_eng), </span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">"Tourists"</span>, </span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab=</span><span class="st">"Spatially Lag tourists"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-207-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Notice that the plots are split in 4 quadrants. The top right corner belongs to areas that have high tourism numbers and are surrounded by other areas that have the average level of revenue.</p>
</section>
<section id="preparing-lisa-map-classes-1" class="level3">
<h3 class="anchored" data-anchor-id="preparing-lisa-map-classes-1"><strong>Preparing LISA map classes</strong></h3>
<p>The code chunks below show the steps to prepare a LISA cluster map.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-40-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-1" role="tab" aria-controls="tabset-40-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-2" role="tab" aria-controls="tabset-40-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-3" role="tab" aria-controls="tabset-40-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-40-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-40-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>quadrantpre <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI1))</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>Pre<span class="sc">$</span>lag_value <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_qlocal1, Pre<span class="sc">$</span>value)</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>DV1 <span class="ot">&lt;-</span> Pre<span class="sc">$</span>lag_value <span class="sc">-</span> <span class="fu">mean</span>(Pre<span class="sc">$</span>lag_value)     </span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a>LM_IPre <span class="ot">&lt;-</span> localMI1[,<span class="dv">1</span>]   </span>
<span id="cb404-5"><a href="#cb404-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb404-6"><a href="#cb404-6" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb404-7"><a href="#cb404-7" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb404-8"><a href="#cb404-8" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb404-9"><a href="#cb404-9" aria-hidden="true" tabindex="-1"></a>quadrantpre[DV1 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPre<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb404-10"><a href="#cb404-10" aria-hidden="true" tabindex="-1"></a>quadrantpre[localMI1[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-40-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>quadrantcov <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI2))</span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>Cov<span class="sc">$</span>lag_value <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_qlocal2, Cov<span class="sc">$</span>value)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>DV2 <span class="ot">&lt;-</span> Cov<span class="sc">$</span>lag_value <span class="sc">-</span> <span class="fu">mean</span>(Cov<span class="sc">$</span>lag_value)     </span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>LM_ICov <span class="ot">&lt;-</span> localMI2[,<span class="dv">1</span>]   </span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true" tabindex="-1"></a>quadrantcov[DV2 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_ICov<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb405-10"><a href="#cb405-10" aria-hidden="true" tabindex="-1"></a>quadrantcov[localMI2[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-40-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>quadrantpost <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI3))</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>Post<span class="sc">$</span>lag_value <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(rswm_qlocal3, Post<span class="sc">$</span>value)</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>DV3 <span class="ot">&lt;-</span> Post<span class="sc">$</span>lag_value <span class="sc">-</span> <span class="fu">mean</span>(Post<span class="sc">$</span>lag_value)     </span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>LM_IPost <span class="ot">&lt;-</span> localMI3[,<span class="dv">1</span>]   </span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span>       </span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb406-7"><a href="#cb406-7" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb406-8"><a href="#cb406-8" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span>  </span>
<span id="cb406-9"><a href="#cb406-9" aria-hidden="true" tabindex="-1"></a>quadrantpost[DV3 <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_IPost<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span>    </span>
<span id="cb406-10"><a href="#cb406-10" aria-hidden="true" tabindex="-1"></a>quadrantpost[localMI3[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="plotting-lisa-map-1" class="level3">
<h3 class="anchored" data-anchor-id="plotting-lisa-map-1"><strong>Plotting LISA map</strong></h3>
<p>Now, we can build the LISA map by using the code chunks below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-41-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-1" role="tab" aria-controls="tabset-41-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-2" role="tab" aria-controls="tabset-41-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-3" role="tab" aria-controls="tabset-41-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-41-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-41-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>Pre.localMI<span class="sc">$</span>quadrantpre <span class="ot">&lt;-</span> quadrantpre</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Pre.localMI) <span class="sc">+</span></span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrantpre"</span>, </span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpre)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpre)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-211-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-41-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>Cov.localMI<span class="sc">$</span>quadrantcov <span class="ot">&lt;-</span> quadrantcov</span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Cov.localMI) <span class="sc">+</span></span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrantcov"</span>, </span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantcov)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantcov)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-212-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-41-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>Post.localMI<span class="sc">$</span>quadrantpost <span class="ot">&lt;-</span> quadrantpost</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Post.localMI) <span class="sc">+</span></span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrantpost"</span>, </span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpost)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrantpost)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-213-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="hot-spot-and-cold-spot-area-analysis-1" class="level1">
<h1><strong>Hot Spot and Cold Spot Area Analysis</strong></h1>
<p>Beside detecting cluster and outliers, localised spatial statistics can be also used to detect hot spot and/or cold spot areas.</p>
<p>The term ‘hot spot’ has been used generically across disciplines to describe a region or value that is higher relative to its surroundings (Lepers et al 2005, Aben et al 2012, Isobe et al 2015).</p>
<section id="getis-and-ords-g-statistics-1" class="level3">
<h3 class="anchored" data-anchor-id="getis-and-ords-g-statistics-1"><strong>Getis and Ord’s G-Statistics</strong></h3>
<p>An alternative spatial statistics to detect spatial anomalies is the Getis and Ord’s G-statistics (Getis and Ord, 1972; Ord and Getis, 1995). It looks at neighbours within a defined proximity to identify where either high or low values clutser spatially. Here, statistically significant hot-spots are recognised as areas of high values where other areas within a neighbourhood range also share high values too.</p>
<p>The analysis consists of three steps:</p>
<ul>
<li><p>Deriving spatial weight matrix</p></li>
<li><p>Computing Gi statistics</p></li>
<li><p>Mapping Gi statistics</p></li>
</ul>
</section>
<section id="deriving-distance-based-weight-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="deriving-distance-based-weight-matrix-1"><strong>Deriving distance-based weight matrix</strong></h3>
<p>First, we need to define a new set of neighbours. Whist the spatial autocorrelation considered units which shared borders, for Getis-Ord we are defining neighbours based on distance.</p>
<p>There are two type of distance-based proximity matrix, they are:</p>
<ul>
<li><p>fixed distance weight matrix; and</p></li>
<li><p>adaptive distance weight matrix.</p></li>
</ul>
<section id="deriving-the-centroid-1" class="level4">
<h4 class="anchored" data-anchor-id="deriving-the-centroid-1">Deriving the centroid</h4>
<p>We will need points to associate with each polygon before we can make our connectivity graph. It will be a little more complicated than just running <em>st_centroid()</em> on the sf object: <strong>us.bound</strong>. We need the coordinates in a separate data frame for this to work. To do this we will use a mapping function. The mapping function applies a given function to each element of a vector and returns a vector of the same length. Our input vector will be the geometry column of us.bound. Our function will be <em>st_centroid()</em>. We will be using map_dbl variation of map from the purrr package. For more documentation, check out map documentation</p>
<p>To get our longitude values we map the <em>st_centroid()</em> function over the geometry column of us.bound and access the longitude value through double bracket notation [[]] and 1. This allows us to get only the longitude, which is the first value in each centroid.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-42-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-1" role="tab" aria-controls="tabset-42-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-2" role="tab" aria-controls="tabset-42-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-3" role="tab" aria-controls="tabset-42-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-42-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-42-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>longitude1 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Pre<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for latitude with one key difference. We access the second value per each centroid with [[2]].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>latitude1 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Pre<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>coords1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude1, latitude1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-42-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>longitude2 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Cov<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for latitude with one key difference. We access the second value per each centroid with [[2]].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>latitude2 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Cov<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>coords2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude2, latitude2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-42-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a>longitude3 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Post<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for latitude with one key difference. We access the second value per each centroid with [[2]].</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>latitude3 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(Post<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a>coords3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude3, latitude3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="determine-the-cut-off-distance-1" class="level4">
<h4 class="anchored" data-anchor-id="determine-the-cut-off-distance-1">Determine the cut-off distance</h4>
<p>Firstly, we need to determine the upper limit for distance band by using the steps below:</p>
<ul>
<li><p>Return a matrix with the indices of points belonging to the set of the k nearest neighbours of each other by using <a href="https://r-spatial.github.io/spdep/reference/knearneigh.html"><em>knearneigh()</em></a> of <strong>spdep</strong>.</p></li>
<li><p>Convert the knn object returned by <em>knearneigh()</em> into a neighbours list of class nb with a list of integer vectors containing neighbour region number ids by using <a href="https://r-spatial.github.io/spdep/reference/knn2nb.html"><em>knn2nb()</em></a>.</p></li>
<li><p>Return the length of neighbour relationship edges by using <a href="https://r-spatial.github.io/spdep/reference/nbdists.html"><em>nbdists()</em></a> of <strong>spdep</strong>. The function returns in the units of the coordinates if the coordinates are projected, in km otherwise.</p></li>
<li><p>Remove the list structure of the returned object by using <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/unlist"><strong>unlist()</strong></a>.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-43-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-1" role="tab" aria-controls="tabset-43-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-2" role="tab" aria-controls="tabset-43-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-3" role="tab" aria-controls="tabset-43-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-43-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-43-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>k1pre <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords1)): neighbour object has 18 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>k1distspre <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1pre, coords1, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1distspre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   52.52   69.06   66.79   77.42  124.72 </code></pre>
</div>
</div>
</div>
<div id="tabset-43-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>k1cov <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords2)): neighbour object has 18 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>k1distscov <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1cov, coords2, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1distscov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   52.52   69.06   66.79   77.42  124.72 </code></pre>
</div>
</div>
</div>
<div id="tabset-43-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>k1post <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords3)): neighbour object has 18 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>k1distspost <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1post, coords3, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1distspost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  21.55   52.52   69.06   66.79   77.42  124.72 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The summary report shows that the largest first nearest neighbour distance is 53 km, so using this as the upper threshold gives certainty that all units will have at least one neighbour.</p>
</section>
<section id="computing-fixed-distance-weight-matrix-1" class="level4">
<h4 class="anchored" data-anchor-id="computing-fixed-distance-weight-matrix-1">Computing fixed distance weight matrix</h4>
<p>Now, we will compute the distance weight matrix by using <a href="https://r-spatial.github.io/spdep/reference/dnearneigh.html"><em>dnearneigh()</em></a> as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>wm_d53 <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords1, <span class="dv">0</span>, <span class="dv">53</span>, <span class="at">longlat =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dnearneigh(coords1, 0, 53, longlat = TRUE): neighbour object has 55
sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>wm_d53</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 40 
Percentage nonzero weights: 0.8401596 
Average number of links: 0.5797101 
51 regions with no links:
9, 10, 11, 12, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29,
30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
48, 50, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 67, 68, 69
55 disjoint connected subgraphs</code></pre>
</div>
</div>
<p>Next,&nbsp;<em>nb2listw()</em>&nbsp;is used to convert the nb object into spatial weights object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>wm53_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_d53, <span class="at">style =</span> <span class="st">'B'</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>)</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm53_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 40 
Percentage nonzero weights: 0.8401596 
Average number of links: 0.5797101 
51 regions with no links:
9, 10, 11, 12, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29,
30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
48, 50, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 67, 68, 69
55 disjoint connected subgraphs
Link number distribution:

 0  1  2  3  4  6 
51  9  2  3  3  1 
9 least connected regions:
7 8 13 18 20 49 51 65 66 with 1 link
1 most connected region:
3 with 6 links

Weights style: B 
Weights constants summary:
   n  nn S0 S1  S2
B 18 324 40 80 512</code></pre>
</div>
</div>
<p>The output spatial weights object is called <code>wm53_lw</code>.</p>
</section>
</section>
<section id="computing-adaptive-distance-weight-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="computing-adaptive-distance-weight-matrix-1"><strong>Computing adaptive distance weight matrix</strong></h3>
<p>One of the characteristics of fixed distance weight matrix is that more densely settled areas (usually the urban areas) tend to have more neighbours and the less densely settled areas (usually the rural counties) tend to have lesser neighbours. Having many neighbours smoothes the neighbour relationship across more neighbours.</p>
<p>It is possible to control the numbers of neighbours directly using k-nearest neighbours, either accepting asymmetric neighbours or imposing symmetry as shown in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>knn <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords1, <span class="at">k=</span><span class="dv">8</span>))</span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a>knn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 69 
Number of nonzero links: 552 
Percentage nonzero weights: 11.5942 
Average number of links: 8 
Non-symmetric neighbours list</code></pre>
</div>
</div>
<p>Next,&nbsp;<em>nb2listw()</em>&nbsp;is used to convert the nb object into spatial weights object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a>knn_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(knn_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 69 
Number of nonzero links: 552 
Percentage nonzero weights: 11.5942 
Average number of links: 8 
Non-symmetric neighbours list
Link number distribution:

 8 
69 
69 least connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 with 8 links
69 most connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 with 8 links

Weights style: B 
Weights constants summary:
   n   nn  S0  S1    S2
B 69 4761 552 972 18472</code></pre>
</div>
</div>
</section>
<section id="computing-gi-statistics-1" class="level2">
<h2 class="anchored" data-anchor-id="computing-gi-statistics-1"><strong>Computing Gi statistics</strong></h2>
<section id="gi-statistics-using-fixed-distance-1" class="level3">
<h3 class="anchored" data-anchor-id="gi-statistics-using-fixed-distance-1"><strong>Gi statistics using fixed distance</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>fips11 <span class="ot">&lt;-</span> <span class="fu">order</span>(Pre<span class="sc">$</span>province_eng)</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a>gi.fixedPre <span class="ot">&lt;-</span> <span class="fu">localG</span>(Pre<span class="sc">$</span>value, wm53_lw)</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>gi.fixedCov <span class="ot">&lt;-</span> <span class="fu">localG</span>(Cov<span class="sc">$</span>value, wm53_lw)</span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>gi.fixedPost <span class="ot">&lt;-</span> <span class="fu">localG</span>(Post<span class="sc">$</span>value, wm53_lw)</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>gi.fixedPre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.5383191  4.1164474  2.7512490  3.5470555 -0.4026612 -0.3357902
 [7] -0.2457078 -0.1969911        NaN        NaN        NaN        NaN
[13] -0.2030295        NaN        NaN        NaN        NaN -0.2498655
[19]        NaN -0.2470666        NaN        NaN        NaN        NaN
[25]        NaN        NaN        NaN        NaN        NaN        NaN
[31]        NaN        NaN        NaN        NaN        NaN        NaN
[37]        NaN        NaN        NaN        NaN        NaN        NaN
[43]        NaN        NaN        NaN        NaN        NaN        NaN
[49] -0.2303579        NaN -0.2451642 -0.3228881  3.4844781 -0.3246697
[55]        NaN        NaN        NaN        NaN        NaN        NaN
[61]        NaN        NaN        NaN        NaN -0.2273087 -0.1836100
[67]        NaN        NaN        NaN
attr(,"internals")
                Gi      E(Gi)       V(Gi)      Z(Gi) Pr(z != E(Gi))
 [1,] 0.0134300865 0.05882353 0.007110607 -0.5383191   5.903568e-01
 [2,] 0.4533721254 0.04411765 0.009884205  4.1164474   3.847571e-05
 [3,] 0.4656350137 0.08823529 0.018816696  2.7512490   5.936851e-03
 [4,] 0.4622451444 0.05882353 0.012935474  3.5470555   3.895625e-04
 [5,] 0.0038712756 0.04411765 0.009990196 -0.4026612   6.871975e-01
 [6,] 0.0108224952 0.04411765 0.009831639 -0.3357902   7.370291e-01
 [7,] 0.0004259691 0.01470588 0.003377640 -0.2457078   8.059085e-01
 [8,] 0.0032270112 0.01470588 0.003395512 -0.1969911   8.438345e-01
 [9,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[10,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[11,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[12,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[13,] 0.0028707049 0.01470588 0.003398063 -0.2030295   8.391120e-01
[14,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[15,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[16,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[17,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[18,] 0.0001846243 0.01470588 0.003377504 -0.2498655   8.026914e-01
[19,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[20,] 0.0003498075 0.01470588 0.003376318 -0.2470666   8.048567e-01
[21,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[22,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[23,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[24,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[25,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[26,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[27,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[28,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[29,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[30,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[31,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[32,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[33,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[34,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[35,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[36,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[37,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[38,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[39,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[40,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[41,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[42,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[43,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[44,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[45,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[46,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[47,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[48,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[49,] 0.0012969999 0.01470588 0.003388277 -0.2303579   8.178137e-01
[50,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[51,] 0.0004268373 0.01470588 0.003392222 -0.2451642   8.063293e-01
[52,] 0.0030097515 0.02941176 0.006686057 -0.3228881   7.467800e-01
[53,] 0.4549547881 0.05882353 0.012924172  3.4844781   4.930977e-04
[54,] 0.0029008502 0.02941176 0.006667545 -0.3246697   7.454311e-01
[55,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[56,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[57,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[58,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[59,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[60,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[61,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[62,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[63,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[64,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[65,] 0.0014442532 0.01470588 0.003403780 -0.2273087   8.201837e-01
[66,] 0.0040228143 0.01470588 0.003385316 -0.1836100   8.543194e-01
[67,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[68,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[69,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
attr(,"cluster")
 [1] High Low  Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low  Low  Low 
[16] Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[31] Low  High Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[46] Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  High Low  High High High
[61] Low  Low  High Low  Low  Low  Low  Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Pre$value, listw = wm53_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>gi.fixedCov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.7831494  3.9662495  2.5997761  3.4296475 -0.5061695 -0.3734480
 [7] -0.3134612 -0.2021130        NaN        NaN        NaN        NaN
[13] -0.2351705        NaN        NaN        NaN        NaN -0.3219900
[19]        NaN -0.3182126        NaN        NaN        NaN        NaN
[25]        NaN        NaN        NaN        NaN        NaN        NaN
[31]        NaN        NaN        NaN        NaN        NaN        NaN
[37]        NaN        NaN        NaN        NaN        NaN        NaN
[43]        NaN        NaN        NaN        NaN        NaN        NaN
[49] -0.2651373        NaN -0.3121159 -0.4106284  3.3484888 -0.3980288
[55]        NaN        NaN        NaN        NaN        NaN        NaN
[61]        NaN        NaN        NaN        NaN -0.2843408 -0.2007843
[67]        NaN        NaN        NaN
attr(,"internals")
                Gi      E(Gi)       V(Gi)      Z(Gi) Pr(z != E(Gi))
 [1,] 0.0126827193 0.05882353 0.003471212 -0.7831494   4.335394e-01
 [2,] 0.3461358221 0.04411765 0.005798372  3.9662495   7.301244e-05
 [3,] 0.3615873786 0.08823529 0.011055360  2.5997761   9.328460e-03
 [4,] 0.3576247499 0.05882353 0.007590419  3.4296475   6.043657e-04
 [5,] 0.0052611336 0.04411765 0.005892990 -0.5061695   6.127377e-01
 [6,] 0.0157511317 0.04411765 0.005769679 -0.3734480   7.088150e-01
 [7,] 0.0007502329 0.01470588 0.001982131 -0.3134612   7.539303e-01
 [8,] 0.0056733977 0.01470588 0.001997220 -0.2021130   8.398284e-01
 [9,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[10,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[11,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[12,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[13,] 0.0041791200 0.01470588 0.002003659 -0.2351705   8.140764e-01
[14,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[15,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[16,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[17,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[18,] 0.0003728076 0.01470588 0.001981499 -0.3219900   7.474602e-01
[19,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[20,] 0.0005436309 0.01470588 0.001980750 -0.3182126   7.503236e-01
[21,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[22,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[23,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[24,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[25,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[26,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[27,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[28,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[29,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[30,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[31,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[32,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[33,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[34,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[35,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[36,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[37,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[38,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[39,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[40,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[41,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[42,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[43,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[44,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[45,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[46,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[47,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[48,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[49,] 0.0028643368 0.01470588 0.001994689 -0.2651373   7.909037e-01
[50,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[51,] 0.0007530601 0.01470588 0.001998446 -0.3121159   7.549525e-01
[52,] 0.0036655606 0.02941176 0.003931229 -0.4106284   6.813450e-01
[53,] 0.3502959777 0.05882353 0.007577000  3.3484888   8.125356e-04
[54,] 0.0044794304 0.02941176 0.003923711 -0.3980288   6.906090e-01
[55,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[56,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[57,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[58,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[59,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[60,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[61,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[62,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[63,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[64,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[65,] 0.0019768783 0.01470588 0.002004059 -0.2843408   7.761492e-01
[66,] 0.0057541569 0.01470588 0.001987714 -0.2007843   8.408672e-01
[67,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[68,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[69,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
attr(,"cluster")
 [1] High Low  Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low  Low  High
[16] Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[31] Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low  Low  Low 
[46] Low  Low  Low  Low  High Low  Low  Low  Low  High High Low  High High High
[61] Low  Low  High Low  Low  Low  Low  Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Cov$value, listw = wm53_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>gi.fixedPost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.5470651  3.8342209  2.5427341  3.3295534 -0.4377064 -0.3122170
 [7] -0.2781334 -0.2257914        NaN        NaN        NaN        NaN
[13] -0.1731786        NaN        NaN        NaN        NaN -0.2870364
[19]        NaN -0.2837764        NaN        NaN        NaN        NaN
[25]        NaN        NaN        NaN        NaN        NaN        NaN
[31]        NaN        NaN        NaN        NaN        NaN        NaN
[37]        NaN        NaN        NaN        NaN        NaN        NaN
[43]        NaN        NaN        NaN        NaN        NaN        NaN
[49] -0.2028662        NaN -0.2768808 -0.3583855  3.2567634 -0.3761799
[55]        NaN        NaN        NaN        NaN        NaN        NaN
[61]        NaN        NaN        NaN        NaN -0.2761819 -0.2227700
[67]        NaN        NaN        NaN
attr(,"internals")
                Gi      E(Gi)       V(Gi)      Z(Gi) Pr(z != E(Gi))
 [1,] 0.0148644117 0.05882353 0.006456838 -0.5470651   0.5843340083
 [2,] 0.3750482011 0.04411765 0.007449369  3.8342209   0.0001259629
 [3,] 0.3912961210 0.08823529 0.014205539  2.5427341   0.0109988895
 [4,] 0.3876400776 0.05882353 0.009752936  3.3295534   0.0008698540
 [5,] 0.0060049301 0.04411765 0.007581829 -0.4377064   0.6615991062
 [6,] 0.0172480170 0.04411765 0.007406455 -0.3122170   0.7548756480
 [7,] 0.0006745191 0.01470588 0.002545033 -0.2781334   0.7809099559
 [8,] 0.0032515139 0.01470588 0.002573521 -0.2257914   0.8213636912
 [9,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[10,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[11,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[12,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[13,] 0.0059456728 0.01470588 0.002558825 -0.1731786   0.8625110470
[14,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[15,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[16,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[17,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[18,] 0.0002304285 0.01470588 0.002543258 -0.2870364   0.7740844499
[19,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[20,] 0.0003974224 0.01470588 0.002542338 -0.2837764   0.7765817474
[21,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[22,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[23,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[24,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[25,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[26,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[27,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[28,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[29,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[30,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[31,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[32,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[33,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[34,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[35,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[36,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[37,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[38,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[39,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[40,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[41,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[42,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[43,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[44,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[45,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[46,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[47,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[48,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[49,] 0.0044586917 0.01470588 0.002551468 -0.2028662   0.8392395771
[50,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[51,] 0.0006772503 0.01470588 0.002567113 -0.2768808   0.7818716470
[52,] 0.0039571089 0.02941176 0.005044680 -0.3583855   0.7200548514
[53,] 0.3799951396 0.05882353 0.009725275  3.2567634   0.0011269032
[54,] 0.0026675706 0.02941176 0.005054380 -0.3761799   0.7067831587
[55,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[56,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[57,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[58,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[59,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[60,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[61,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[62,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[63,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[64,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[65,] 0.0007317949 0.01470588 0.002560097 -0.2761819   0.7824083619
[66,] 0.0034673922 0.01470588 0.002545086 -0.2227700   0.8237145099
[67,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[68,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
[69,] 0.0000000000 0.00000000 0.000000000        NaN            NaN
attr(,"cluster")
 [1] High Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[16] Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low  Low 
[31] Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low  Low  Low 
[46] Low  Low  Low  Low  High Low  Low  Low  Low  High High Low  High High High
[61] Low  Low  High Low  Low  Low  Low  Low  Low 
Levels: Low High
attr(,"gstari")
[1] FALSE
attr(,"call")
localG(x = Post$value, listw = wm53_lw)
attr(,"class")
[1] "localG"</code></pre>
</div>
</div>
<p>The output of localG() is a vector of G or Gstar values, with attributes “gstari” set to TRUE or FALSE, “call” set to the function call, and class “localG”.</p>
<p>The Gi statistics is represented as a Z-score. Greater values represent a greater intensity of clustering and the direction (positive or negative) indicates high or low clusters.</p>
<p>Next, we will join the Gi values to their corresponding tourist sf data frame by using the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-44-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-1" role="tab" aria-controls="tabset-44-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-2" role="tab" aria-controls="tabset-44-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-3" role="tab" aria-controls="tabset-44-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-44-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-44-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>Pre.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Pre, <span class="fu">as.matrix</span>(gi.fixedPre)) <span class="sc">%&gt;%</span></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixedPre.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-44-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>Cov.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Cov, <span class="fu">as.matrix</span>(gi.fixedCov)) <span class="sc">%&gt;%</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixedCov.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-44-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>Post.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Post, <span class="fu">as.matrix</span>(gi.fixedPost)) <span class="sc">%&gt;%</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_fixed =</span> as.matrix.gi.fixedPost.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>In fact, the code chunk above performs three tasks. First, it convert the output vector (i.e.&nbsp;<em>gi.fixed</em>) into r matrix object by using <em>as.matrix()</em>. Next, <em>cbind()</em> is used to join data and <em>gi.fixed</em> matrix to produce a new SpatialPolygonDataFrame called <em>pre/cov/pre.gi</em>. Lastly, the field name of the gi values is renamed to <em>gstat_fixed</em> by using <em>rename()</em>.</p>
</section>
<section id="mapping-gi-values-with-fixed-distance-weights-1" class="level3">
<h3 class="anchored" data-anchor-id="mapping-gi-values-with-fixed-distance-weights-1"><strong>Mapping Gi values with fixed distance weights</strong></h3>
<p>The code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-45-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-1" role="tab" aria-controls="tabset-45-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-2" role="tab" aria-controls="tabset-45-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-3" role="tab" aria-controls="tabset-45-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-45-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-45-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>RevenuePre <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Pre, <span class="st">"value"</span>)</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>Gimap1 <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Pre.gi) <span class="sc">+</span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(RevenuePre, Gimap1, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Some legend labels were too wide. These labels have been resized to 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_fixed" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-234-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-45-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>RevenueCov <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Cov, <span class="st">"value"</span>)</span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a>Gimap2 <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Cov.gi) <span class="sc">+</span></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb453-5"><a href="#cb453-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb453-6"><a href="#cb453-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb453-7"><a href="#cb453-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb453-8"><a href="#cb453-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb453-9"><a href="#cb453-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-10"><a href="#cb453-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(RevenueCov, Gimap2, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_fixed" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-235-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-45-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>RevenuePost <span class="ot">&lt;-</span> <span class="fu">qtm</span>(Post, <span class="st">"value"</span>)</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a>Gimap3 <span class="ot">&lt;-</span><span class="fu">tm_shape</span>(Post.gi) <span class="sc">+</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_fixed"</span>, </span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>,</span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(RevenuePost, Gimap3, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_fixed" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-236-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="gi-statistics-using-adaptive-distance-1" class="level3">
<h3 class="anchored" data-anchor-id="gi-statistics-using-adaptive-distance-1"><strong>Gi statistics using adaptive distance</strong></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-46-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-1" role="tab" aria-controls="tabset-46-1" aria-selected="true">Pre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-2" role="tab" aria-controls="tabset-46-2" aria-selected="false">Cov</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-3" role="tab" aria-controls="tabset-46-3" aria-selected="false">Post</a></li></ul>
<div class="tab-content">
<div id="tabset-46-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-46-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a>fips1 <span class="ot">&lt;-</span> <span class="fu">order</span>(Pre<span class="sc">$</span>province_eng)</span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive1 <span class="ot">&lt;-</span> <span class="fu">localG</span>(Pre<span class="sc">$</span>value, knn_lw)</span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a>Pre.gi1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Pre, <span class="fu">as.matrix</span>(gi.adaptive1)) <span class="sc">%&gt;%</span></span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive1.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-46-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>fips2 <span class="ot">&lt;-</span> <span class="fu">order</span>(Cov<span class="sc">$</span>province_eng)</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive2 <span class="ot">&lt;-</span> <span class="fu">localG</span>(Cov<span class="sc">$</span>value, knn_lw)</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>Cov.gi2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Cov, <span class="fu">as.matrix</span>(gi.adaptive2)) <span class="sc">%&gt;%</span></span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive2.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-46-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a>fips3 <span class="ot">&lt;-</span> <span class="fu">order</span>(Post<span class="sc">$</span>province_eng)</span>
<span id="cb459-2"><a href="#cb459-2" aria-hidden="true" tabindex="-1"></a>gi.adaptive3 <span class="ot">&lt;-</span> <span class="fu">localG</span>(Post<span class="sc">$</span>value, knn_lw)</span>
<span id="cb459-3"><a href="#cb459-3" aria-hidden="true" tabindex="-1"></a>Post.gi3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Post, <span class="fu">as.matrix</span>(gi.adaptive3)) <span class="sc">%&gt;%</span></span>
<span id="cb459-4"><a href="#cb459-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive3.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mapping-gi-values-with-adaptive-distance-weights-1" class="level3">
<h3 class="anchored" data-anchor-id="mapping-gi-values-with-adaptive-distance-weights-1"><strong>Mapping Gi values with adaptive distance weights</strong></h3>
<p>It is time for us to visualise the locations of hot spot and cold spot areas. The choropleth mapping functions of <strong>tmap</strong> package will be used to map the Gi values.</p>
<p>The code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>Gimap1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Pre.gi1) <span class="sc">+</span> </span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a>Gimap2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Cov.gi2) <span class="sc">+</span> </span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb460-13"><a href="#cb460-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb460-14"><a href="#cb460-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-15"><a href="#cb460-15" aria-hidden="true" tabindex="-1"></a>Gimap3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(Post.gi3) <span class="sc">+</span> </span>
<span id="cb460-16"><a href="#cb460-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb460-17"><a href="#cb460-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb460-18"><a href="#cb460-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb460-19"><a href="#cb460-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb460-20"><a href="#cb460-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb460-21"><a href="#cb460-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-22"><a href="#cb460-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>( </span>
<span id="cb460-23"><a href="#cb460-23" aria-hidden="true" tabindex="-1"></a>             Gimap1,</span>
<span id="cb460-24"><a href="#cb460-24" aria-hidden="true" tabindex="-1"></a>             Gimap2,</span>
<span id="cb460-25"><a href="#cb460-25" aria-hidden="true" tabindex="-1"></a>             Gimap3,</span>
<span id="cb460-26"><a href="#cb460-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb460-27"><a href="#cb460-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.
Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.
Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-240-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="cold-hot-map-revenue" class="level1">
<h1>Cold hot map Revenue</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>RevenueAll <span class="ot">=</span> revallRAW </span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a>RevenueAll<span class="sc">$</span>YYYYMM <span class="ot">=</span> <span class="fu">as.integer</span>(<span class="fu">format</span>(RevenueAll<span class="sc">$</span>date, <span class="st">"%Y%m"</span>))</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a>RevenueAll<span class="sc">$</span>Year <span class="ot">=</span> <span class="fu">as.integer</span>(<span class="fu">format</span>(RevenueAll<span class="sc">$</span>Year))  </span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a>RevenueAll <span class="ot">=</span> RevenueAll <span class="sc">%&gt;%</span>   </span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a>Revenue_st <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(</span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> RevenueAll, </span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.geometry =</span> admRAW, </span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.loc_col =</span> <span class="st">"province_eng"</span>, </span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">.time_col =</span> <span class="st">"YYYYMM"</span></span>
<span id="cb463-6"><a href="#cb463-6" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(Revenue_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>Revenue_nb <span class="ot">=</span> Revenue_st <span class="sc">%&gt;%</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(</span>
<span id="cb466-4"><a href="#cb466-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb466-5"><a href="#cb466-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wt =</span> <span class="fu">st_inverse_distance</span>(nb,</span>
<span id="cb466-6"><a href="#cb466-6" aria-hidden="true" tabindex="-1"></a>                             geometry,</span>
<span id="cb466-7"><a href="#cb466-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb466-8"><a href="#cb466-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb466-9"><a href="#cb466-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-10"><a href="#cb466-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb466-11"><a href="#cb466-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Polygon provided. Using point on surface.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 3 warnings in `stopifnot()`.
The first warning was:
ℹ In argument: `nb = include_self(st_contiguity(geometry))`.
Caused by warning in `spdep::poly2nb()`:
! some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.
ℹ Run `dplyr::last_dplyr_warnings()` to see the 2 remaining warnings.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co">#RevenueAll$YYYYMM &lt;- as.numeric(as.character(RevenueAll$YYYYMM))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co">#gi_stars = Revenue_nb %&gt;%</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># group_by(YYYYMM) %&gt;%</span></span>
<span id="cb470-3"><a href="#cb470-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(gi_star = local_gstar_perm(</span></span>
<span id="cb470-4"><a href="#cb470-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># RevenueAll, nb, wt)) %&gt;%</span></span>
<span id="cb470-5"><a href="#cb470-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tidyr::unnest(gi_star)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ehsa = gi_stars %&gt;%</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># group_by(province_eng) %&gt;%</span></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#summarise(mk = list(</span></span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># unclass(</span></span>
<span id="cb471-5"><a href="#cb471-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  Kendall::MannKendall(gi_star)))) %&gt;%</span></span>
<span id="cb471-6"><a href="#cb471-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tidyr::unnest_wider(mk)</span></span>
<span id="cb471-7"><a href="#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="co">#head(ehsa)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">=</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Revenue_st,</span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"value"</span>,</span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>,</span>
<span id="cb473-5"><a href="#cb473-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb473-6"><a href="#cb473-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in spdep::poly2nb(geometry, queen = queen, ...): some observations have no neighbours;
if this seems unexpected, try increasing the snap argument.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in spdep::poly2nb(geometry, queen = queen, ...): neighbour object has 2 sub-graphs;
if this sub-graph count seems unexpected, try increasing the snap argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ehsa,</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classification))<span class="sc">+</span></span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-250-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>Revenue_ehsa <span class="ot">=</span> admRAW <span class="sc">%&gt;%</span></span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(province_eng <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">=</span> Revenue_ehsa <span class="sc">%&gt;%</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Revenue_ehsa)<span class="sc">+</span></span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb480-3"><a href="#cb480-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb480-4"><a href="#cb480-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb480-5"><a href="#cb480-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>)<span class="sc">+</span></span>
<span id="cb480-6"><a href="#cb480-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Legend labels were too wide. The labels have been resized to 0.52, 0.58, 0.61. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home_Exercise02_files/figure-html/unnamed-chunk-252-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Pelle Knegjes</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>